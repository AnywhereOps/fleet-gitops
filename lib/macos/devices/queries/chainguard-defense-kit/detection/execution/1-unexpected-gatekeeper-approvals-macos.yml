- name: CDK - Unexpected Gatekeeper Approvals Macos
  description: Gatekeeper exceptions are exceptions for downloaded binaries
  query: "SELECT\n  gap.ctime,\n  gap.mtime,\n  gap.path,\n  file.mtime,\n  file.uid,\n\
    \  file.ctime,\n  file.gid,\n  hash.sha256,\n  signature.identifier,\n  signature.authority\n\
    FROM\n  gatekeeper_approved_apps AS gap\n  LEFT JOIN file ON gap.path = file.path\n\
    \  LEFT JOIN hash ON gap.path = hash.path\n  LEFT JOIN signature ON gap.path =\
    \ signature.path\nWHERE\n  gap.path NOT LIKE '/Users/%/bin/%'\n  AND gap.path\
    \ NOT LIKE '/Users/%/%_darwin_a%64%'\n  AND gap.path NOT LIKE '/Users/%/%-darwin-a%64'\n\
    \  AND gap.path NOT LIKE '/Users/%/bom'\n  AND gap.path NOT LIKE '/Users/%/configure'\n\
    \  AND gap.path NOT LIKE '/Users/%/cosign-%'\n  AND gap.path NOT LIKE '/Users/%/crane'\n\
    \  AND gap.path NOT LIKE '/Users/%/Downloads/%_arm64%/%'\n  AND gap.path NOT LIKE\
    \ '/Users/%/Downloads/cosign'\n  AND gap.path NOT LIKE '/Users/%/Downloads/grpcurl_%'\n\
    \  AND gap.path NOT LIKE '/Users/%/Downloads/missp'\n  AND gap.path NOT LIKE '/Users/%/Downloads/openresty%/bundle/install'\n\
    \  AND gap.path NOT LIKE '/Users/%/Downloads/twistcli'\n  AND gap.path NOT LIKE\
    \ '/Users/%/Downloads/U_STIGViewer%/STIGViewer'\n  AND gap.path NOT LIKE '/Users/%/rekor-cli'\n\
    \  AND gap.path NOT LIKE '/Users/%/trivy'\n  AND gap.path NOT LIKE '/usr/local/bin/%'\n\
    \  AND signature.authority != 'Developer ID Application: Jamie Zawinski (4627ATJELP)'\n\
    GROUP BY\n  gap.requirement\n"
  platform: darwin
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

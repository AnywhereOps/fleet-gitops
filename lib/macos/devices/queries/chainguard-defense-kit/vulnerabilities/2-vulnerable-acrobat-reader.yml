---
apiVersion: v1
kind: query
spec:
  name: CDK - Vulnerable Acrobat Reader
  platform: darwin
  description: Vulnerable version of Adobe Acrobat Reader is installed
  query: |
    SELECT
      name,
      path,
      bundle_version,
      TRIM(REGEX_MATCH (bundle_version, "^(\d+)\.", 1)) AS major,
      TRIM(REGEX_MATCH (bundle_version, "\.(\d+)$", 1)) AS patch
    FROM
      apps
    WHERE
      name LIKE "%Acrobat%"
      AND (
        (
          major = "23"
          AND CAST(patch AS integer) < 20285
        )
        OR (
          major = "20"
          AND CAST(patch AS integer) < 30517
        )
      )
  interval: 3600
  logging: snapshot
  observer_can_run: true
  automations_enabled: false
  discard_data: false
  team: devices

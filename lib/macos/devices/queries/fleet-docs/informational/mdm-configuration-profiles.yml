---
apiVersion: v1
kind: built-in
spec:
  name: MDM configuration profiles
  platform: darwin
  description: Retrieves information about mobile device management (MDM) configuration profiles installed on a macOS device.
  query: |
    SELECT 1
    WHERE EXISTS (
        SELECT 1
        FROM osquery_registry
        WHERE active = true
          AND registry = 'table'
          AND name = 'macos_profiles'
    )
    AND NOT EXISTS (
        SELECT 1
        FROM osquery_registry
        WHERE active = true
          AND registry = 'table'
          AND name = 'macos_user_profiles'
    );
  purpose: Informational
  tags: built-in
  discovery: macos_profiles
  team: devices

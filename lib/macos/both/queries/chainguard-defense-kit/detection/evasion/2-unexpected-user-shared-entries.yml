- name: CDK - Unexpected User Shared Entries
  description: Find unexpected files in /Users/Shared
  query: "SELECT\n  file.path,\n  file.type,\n  file.size,\n  file.mtime,\n  file.uid,\n\
    \  file.btime,\n  file.mode,\n  file.ctime,\n  file.gid,\n  hash.sha256,\n  magic.data,\n\
    \  RTRIM(\n    COALESCE(\n      REGEX_MATCH (file.directory, '(/.*?/.*?/.*?/)',\
    \ 1),\n      file.directory\n    ),\n    \"/\"\n  ) AS top3_dir\nFROM\n  file\n\
    \  LEFT JOIN hash ON file.path = hash.path\n  LEFT JOIN magic ON file.path = magic.path\n\
    WHERE\n  (\n    file.path LIKE '/Users/Shared/%%'\n    OR file.path LIKE '/Users/Shared/.%'\n\
    \    OR file.path LIKE '/Users/Shared/.%/%%'\n    OR file.path LIKE '/Users/Shared/%/.%'\n\
    \  )\n  AND NOT (\n    file.type = 'directory'\n    OR file.size = 0\n    OR file.path\
    \ LIKE '%/../%'\n    OR file.path LIKE '%/./%'\n    OR file.path IN (\n      '/Users/Shared/.4oaLkgIGnA',\n\
    \      '/Users/Shared/.BetaEnrollmentData.plist',\n      '/Users/Shared/.betamigrated',\n\
    \      '/Users/Shared/.com.intego.reporting.plist',\n      '/Users/Shared/.DS_Store',\n\
    \      '/Users/Shared/.ks.intego_metrics_2.plist',\n      '/Users/Shared/.localized',\n\
    \      '/Users/Shared/.NSVolumeHeap',\n      '/Users/Shared/.SeedEnrollment.plist',\n\
    \      '/Users/Shared/.userfonts.cachedb',\n      '/Users/Shared/CleanMyMac X/.licence',\n\
    \      '/Users/Shared/LogiTuneInstallerStarted.txt',\n      '/Users/Shared/Plugin\
    \ Loading.log'\n    )\n    OR top3_dir IN (\n      '/Users/Shared/.logishrd',\n\
    \      '/Users/Shared/Adobe',\n      '/Users/Shared/AdobeGCData',\n      '/Users/Shared/AdobeGCInfo',\n\
    \      '/Users/Shared/AdobeInstalledCodecsTier2',\n      '/Users/Shared/Audiority',\n\
    \      '/Users/Shared/Canon_Inc_IC',\n      '/Users/Shared/CleanMyMac X Menu',\n\
    \      '/Users/Shared/CleanMyMac X',\n      '/Users/Shared/CleanMyMac_5',\n  \
    \    '/Users/Shared/Electronic Arts',\n      '/Users/Shared/LGHUB',\n      '/Users/Shared/logi',\n\
    \      '/Users/Shared/LogioptionsPlus',\n      '/Users/Shared/LogiOptionsPlus',\n\
    \      '/Users/Shared/logitune',\n      '/Users/Shared/macenhance',\n      '/Users/Shared/Maxon',\n\
    \      '/Users/Shared/Media Cache Files',\n      '/Users/Shared/Media Cache Files/',\n\
    \      '/Users/Shared/Parallels',\n      '/Users/Shared/Pixologic',\n      '/Users/Shared/PPN',\n\
    \      '/Users/Shared/Previously Relocated Items',\n      '/Users/Shared/Red Giant',\n\
    \      '/Users/Shared/Relocated Items',\n      '/Users/Shared/TechSmith',\n  \
    \    '/Users/Shared/UnrealEngine',\n      '/Users/Shared/ZBrushData2024'\n   \
    \ )\n    OR file.path LIKE '/Users/Shared/Epic Games/%'\n    OR file.path LIKE\
    \ \"/Users/Shared/Previously Relocated Items %/%\"\n    OR (\n      file.path\
    \ LIKE \"%.plist\"\n      AND magic.data = 'XML 1.0 document, ASCII text'\n  \
    \  )\n  )\n"
  platform: darwin
  interval: 3600
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

- name: CDK - Spotlight Database Export Macos
  description: Find database exports. Will need tuning based on your table names.
  query: "SELECT\n  f.path,\n  f.size,\n  datetime(f.btime, 'unixepoch') AS file_created,\n\
    \  magic.data\nFROM\n  file f\n  JOIN mdfind ON mdfind.path = f.path\n  LEFT JOIN\
    \ magic ON f.path = magic.path\nWHERE\n  (\n    (\n      mdfind.query = 'kMDItemFSName\
    \ == ''*enforce*'' && kMDItemTextContent == ''CREATE TABLE'''\n    )\n    OR (\n\
    \      mdfind.query = 'kMDItemFSName == ''*iam*'' && kMDItemTextContent == ''CREATE\
    \ TABLE'''\n    )\n    OR (\n      mdfind.query = 'kMDItemFSName == ''*tenant*''\
    \ && kMDItemTextContent == ''CREATE TABLE'''\n    )\n  )\n  AND f.path NOT LIKE\
    \ '%.json'\n  AND f.path NOT LIKE '%.log'\n  AND f.path NOT LIKE '%/testdata/%'\n\
    \  AND f.path NOT LIKE '%mysql-test/suite/%'\n  AND f.size > 32768\n"
  platform: darwin
  interval: 3600
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

- name: Software Firefox
  description: A software override query to differentiate between Firefox and Firefox
    ESR on macOS. Requires fleetd
  query: "WITH app_paths AS (\n        SELECT path\n        FROM apps\n        WHERE\
    \ bundle_identifier = 'org.mozilla.firefox'\n      ),\n      remoting_name AS\
    \ (\n        SELECT value, path\n        FROM parse_ini\n        WHERE key = 'RemotingName'\n\
    \        AND path IN (SELECT CONCAT(path, '/Contents/Resources/application.ini')\
    \ FROM app_paths)\n      )\n      SELECT\n        CASE\n          WHEN remoting_name.value\
    \ = 'firefox-esr' THEN 'Firefox ESR.app'\n          ELSE 'Firefox.app'\n     \
    \   END AS name,\n        COALESCE(NULLIF(apps.bundle_short_version, ''), apps.bundle_version)\
    \ AS version,\n        apps.bundle_identifier AS bundle_identifier,\n        ''\
    \ AS extension_id,\n        '' AS browser,\n        'apps' AS source,\n      \
    \  '' AS vendor,\n        apps.last_opened_time AS last_opened_at,\n        apps.path\
    \ AS installed_path\n      FROM apps\n      LEFT JOIN remoting_name ON apps.path\
    \ = REPLACE(remoting_name.path, '/Contents/Resources/application.ini', '')\n \
    \     WHERE apps.bundle_identifier = 'org.mozilla.firefox'\n"
  platform: darwin

- name: Host certificates (macOS)
  description: Retrieves certificates from an Apple device.
  query: "SELECT\n   ca, common_name, subject, issuer,\n   key_algorithm, key_strength,\
    \ key_usage, signing_algorithm,\n   not_valid_after, not_valid_before,\n   serial,\
    \ sha1, \"system\" as source,\n   path\n FROM\n   certificates\n WHERE\n   path\
    \ = '/Library/Keychains/System.keychain'\n UNION\n SELECT\n   ca, common_name,\
    \ subject, issuer,\n   key_algorithm, key_strength, key_usage, signing_algorithm,\n\
    \   not_valid_after, not_valid_before,\n   serial, sha1, \"user\" as source,\n\
    \   path\n FROM\n   certificates\n WHERE\n   path LIKE '/Users/%/Library/Keychains/login.keychain-db';\n"
  platform: darwin

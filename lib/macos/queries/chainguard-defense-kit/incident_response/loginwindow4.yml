---
apiVersion: v1
kind: query
spec:
  name: CDK - Loginwindow4
  platform: darwin
  description: Retrieves all the values for the loginwindow process in the target OSX system.
  query: |
    select
      username,
      key,
      subkey,
      value
    from
      plist p,
      (
        select
          *
        from
          users
        where
          directory like '/Users/%'
      ) u
    where
      p.path = u.directory || '/Library/Preferences/loginwindow.plist';
  interval: 3600
  logging: snapshot
  observer_can_run: true
  automations_enabled: false
  discard_data: false

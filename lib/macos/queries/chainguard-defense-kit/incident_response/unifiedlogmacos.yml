---
apiVersion: v1
kind: query
spec:
  name: CDK - Unified Log Macos
  platform: darwin
  description: Retrieves recent entries from the macOS unified log
  query: |
    SELECT
      timestamp,
      pid,
      process,
      category,
      subsystem,
      message
    FROM
      unified_log
    WHERE
      timestamp > (strftime('%s', 'now') - 1800)
  interval: 1800
  logging: snapshot
  observer_can_run: true
  automations_enabled: false
  discard_data: false
  team: both

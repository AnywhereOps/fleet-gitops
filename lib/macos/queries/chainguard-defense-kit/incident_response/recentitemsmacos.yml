---
apiVersion: v1
kind: query
spec:
  name: CDK - Recent Items Macos
  platform: darwin
  description: Retrieves the list of recent items opened in OSX by parsing the plist per user.
  query: |
    select
      username,
      key,
      value
    from
      plist p,
      (
        select
          *
        from
          users
        where
          directory like '/Users/%'
      ) u
    where
      p.path = u.directory || '/Library/Preferences/com.apple.recentitems.plist';
  interval: 3600
  logging: snapshot
  observer_can_run: true
  automations_enabled: false
  discard_data: false
  team: both

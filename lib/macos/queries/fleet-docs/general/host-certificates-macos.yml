---
apiVersion: v1
kind: built-in
spec:
  name: Host certificates (macOS)
  platform: darwin
  description: Retrieves certificates from an Apple device.
  query: |
    SELECT
       ca, common_name, subject, issuer,
       key_algorithm, key_strength, key_usage, signing_algorithm,
       not_valid_after, not_valid_before,
       serial, sha1, "system" as source,
       path
     FROM
       certificates
     WHERE
       path = '/Library/Keychains/System.keychain'
     UNION
     SELECT
       ca, common_name, subject, issuer,
       key_algorithm, key_strength, key_usage, signing_algorithm,
       not_valid_after, not_valid_before,
       serial, sha1, "user" as source,
       path
     FROM
       certificates
     WHERE
       path LIKE '/Users/%/Library/Keychains/login.keychain-db';
  purpose: Informational
  tags: built-in

- name: Discover Python Packages from Running Python Interpreters
  description: Attempt to discover Python environments (in cwd, path to the python
    binary, and process command line) from running python interpreters and collect
    Python packages from those environments.
  query: SELECT * FROM python_packages WHERE directory IN (SELECT DISTINCT directory
    FROM (SELECT SUBSTR(path,0,INSTR(path,'/bin/'))||'/lib' AS directory FROM processes
    WHERE path LIKE '%/bin/%' AND path LIKE '%python%' UNION SELECT SUBSTR(cmdline,0,INSTR(cmdline,'/bin/'))||'/lib'
    AS directory FROM processes WHERE cmdline LIKE '%python%' AND cmdline LIKE '%/bin/%'
    AND path LIKE '%python%' UNION SELECT cwd||'/lib' AS directory FROM processes
    WHERE path LIKE '%python%'));
  platform: linux, darwin

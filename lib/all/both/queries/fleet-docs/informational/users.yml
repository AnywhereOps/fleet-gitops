- name: Users
  description: Retrieves information about user accounts.
  query: "WITH cached_groups AS (select * from groups)\n SELECT uid, uuid, username,\
    \ type, groupname, shell\n FROM users LEFT JOIN cached_groups USING (gid)\n WHERE\
    \ type <> 'special' AND shell NOT LIKE '%/false' AND shell NOT LIKE '%/nologin'\
    \ AND shell NOT LIKE '%/shutdown' AND shell NOT LIKE '%/halt' AND username NOT\
    \ LIKE '%$' AND username NOT LIKE '\\_%' ESCAPE '\\' AND NOT (username = 'sync'\
    \ AND shell ='/bin/sync' AND directory <> '')\n"
  platform: darwin, linux, windows

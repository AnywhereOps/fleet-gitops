- name: Network interfaces (macOS/Linux)
  description: Retrieves information about network interfaces on macOS and Linux devices
  query: "SELECT\n    ia.address,\n    id.mac\nFROM\n    interface_addresses ia\n\
    \    JOIN interface_details id ON id.interface = ia.interface\n    JOIN routes\
    \ r ON r.interface = ia.interface\nWHERE\n    (r.destination = '0.0.0.0' OR r.destination\
    \ = '::') AND r.netmask = 0\n    AND r.type = 'gateway'\n    AND (\n    inet_aton(ia.address)\
    \ IS NOT NULL AND (\n      split(ia.address, '.', 0) = '10'\n      OR (split(ia.address,\
    \ '.', 0) = '172' AND (CAST(split(ia.address, '.', 1) AS INTEGER) & 0xf0) = 16)\n\
    \      OR (split(ia.address, '.', 0) = '192' AND split(ia.address, '.', 1) = '168')\n\
    \    )\n    OR (inet_aton(ia.address) IS NULL AND regex_match(lower(ia.address),\
    \ '^f[cd][0-9a-f][0-9a-f]:[0-9a-f:]+', 0) IS NOT NULL)\n  )\nORDER BY\n    r.metric\
    \ ASC,\n  inet_aton(ia.address) IS NOT NULL DESC\nLIMIT 1;\n"
  platform: darwin, linux

---
apiVersion: v1
kind: pack
spec:
  name: LinuxPack
  queries:
  - description: Retrieves all the jobs scheduled in crontab in the target system.
    interval: 86400
    name: crontab_snapshot
    platform: linux
    query: crontab_snapshot
    snapshot: true
  - description: Various Linux kernel integrity checked attributes.
    interval: 86400
    name: kernel_integrity
    platform: linux
    query: kernel_integrity
  - description: Linux kernel modules both loaded and within the load search path.
    interval: 3600
    name: kernel_modules
    platform: linux
    query: kernel_modules
  - description: Retrieves the current list of mounted drives in the target system.
    interval: 86400
    name: mounts
    platform: linux
    query: mounts
  - description: Socket events collected from the audit framework
    interval: 10
    name: socket_events
    platform: linux
    query: socket_events
  - description: Record the network interfaces and their associated IP and MAC addresses
    interval: 600
    name: network_interfaces_snapshot
    platform: linux
    query: network_interfaces_snapshot
    snapshot: true
  - description: Information about the running osquery configuration
    interval: 86400
    name: osquery_info
    platform: linux
    query: osquery_info
    snapshot: true
  - description: Display all installed RPM packages
    interval: 86400
    name: rpm_packages
    platform: centos
    query: rpm_packages
    snapshot: true
  - description: Record shell history for all users on system (instead of just root)
    interval: 3600
    name: shell_history
    platform: linux
    query: shell_history
  - description: File events collected from file integrity monitoring
    interval: 10
    name: file_events
    platform: linux
    query: file_events
    removed: false
  - description: Retrieve the EC2 metadata for this endpoint
    interval: 3600
    name: ec2_instance_metadata
    platform: linux
    query: ec2_instance_metadata
  - description: Retrieve the EC2 tags for this endpoint
    interval: 3600
    name: ec2_instance_tags
    platform: linux
    query: ec2_instance_tags
  - description: Snapshot query to retrieve the EC2 tags for this instance
    interval: 86400
    name: ec2_instance_tags_snapshot
    platform: linux
    query: ec2_instance_tags_snapshot
    snapshot: true
  - description: Retrieves the current filters and chains per filter in the target system.
    interval: 86400
    name: iptables
    platform: linux
    query: iptables
  - description: Display any SUID binaries that are owned by root
    interval: 86400
    name: suid_bin
    platform: linux
    query: suid_bin
  - description: Display all installed DEB packages
    interval: 86400
    name: deb_packages
    platform: ubuntu
    query: deb_packages
    snapshot: true
  - description: Find shell processes that have open sockets
    interval: 600
    name: behavioral_reverse_shell
    platform: linux
    query: behavioral_reverse_shell
  - description: Retrieves all the jobs scheduled in crontab in the target system.
    interval: 3600
    name: crontab
    platform: linux
    query: crontab
  - description: Local system users.
    interval: 86400
    name: users
    platform: linux
    query: users
  - description: Process events collected from the audit framework
    interval: 10
    name: process_events
    platform: linux
    query: process_events
  - description: Retrieves the list of the latest logins with PID, username and timestamp.
    interval: 3600
    name: last
    platform: linux
    query: last
  - description: Any processes that run with an LD_PRELOAD environment variable
    interval: 60
    name: ld_preload
    platform: linux
    query: ld_preload
    snapshot: true
  - description: Information about the system hardware and name
    interval: 86400
    name: system_info
    platform: linux
    query: system_info
    snapshot: true
  - description: Returns the private keys in the users ~/.ssh directory and whether or not they are encrypted
    interval: 86400
    name: user_ssh_keys
    platform: linux
    query: user_ssh_keys
  - description: Local system users.
    interval: 86400
    name: users_snapshot
    platform: linux
    query: users_snapshot
    snapshot: true
  - description: DNS resolvers used by the host
    interval: 3600
    name: dns_resolvers
    platform: linux
    query: dns_resolvers
  - description: Retrieves information from the current kernel in the target system.
    interval: 86400
    name: kernel_info
    platform: linux
    query: kernel_info
    snapshot: true
  - description: Linux kernel modules both loaded and within the load search path.
    interval: 86400
    name: kernel_modules_snapshot
    platform: linux
    query: kernel_modules_snapshot
    snapshot: true
  - description: Generates an event if ld.so.preload is present - used by rootkits such as Jynx
    interval: 3600
    name: ld_so_preload_exists
    platform: linux
    query: ld_so_preload_exists
    snapshot: true
  - description: Records system/user time, db size, and many other system metrics
    interval: 1800
    name: runtime_perf
    platform: linux
    query: runtime_perf
  - description: Retrieves all the entries in the target system /etc/hosts file.
    interval: 86400
    name: etc_hosts_snapshot
    platform: linux
    query: etc_hosts_snapshot
    snapshot: true
  - description: Snapshot query to retrieve the EC2 metadata for this endpoint
    interval: 86400
    name: ec2_instance_metadata_snapshot
    platform: linux
    query: ec2_instance_metadata_snapshot
    snapshot: true
  - description: ''
    interval: 10
    name: hardware_events
    platform: linux
    query: hardware_events
    removed: false
  - description: Information about memory usage on the system
    interval: 3600
    name: memory_info
    platform: linux
    query: memory_info
  - description: Displays information from /proc/stat file about the time the CPU cores spent in different parts of the system
    interval: 3600
    name: cpu_time
    platform: linux
    query: cpu_time
  - description: Retrieves all the entries in the target system /etc/hosts file.
    interval: 3600
    name: etc_hosts
    platform: linux
    query: etc_hosts
  - description: Retrieves information from the Operating System where osquery is currently running.
    interval: 86400
    name: os_version
    platform: linux
    query: os_version
    snapshot: true
  - description: A snapshot of all processes running on the host. Useful for outlier analysis.
    interval: 86400
    name: processes_snapshot
    platform: linux
    query: processes_snapshot
    snapshot: true
  - description: Retrieves the current list of USB devices in the target system.
    interval: 120
    name: usb_devices
    platform: linux
    query: usb_devices
  - description: A line-delimited authorized_keys table.
    interval: 86400
    name: authorized_keys
    platform: linux
    query: authorized_keys
  - description: Display apt package manager sources.
    interval: 86400
    name: apt_sources
    platform: ubuntu
    query: apt_sources
    snapshot: true
  - description: Gather information about processes that are listening on a socket.
    interval: 86400
    name: listening_ports
    platform: linux
    query: listening_ports
    snapshot: true
  - description: Display yum package manager sources.
    interval: 86400
    name: yum_sources
    platform: centos
    query: yum_sources
    snapshot: true
  targets:
    labels:
    - Ubuntu Linux
    - CentOS Linux
  team: both

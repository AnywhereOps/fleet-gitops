- name: CDK - Unexpected Icmp Socket Events
  description: Unexpected programs speaking over ICMP (event-based)
  query: "SELECT\n  se.*,\n  p.path,\n  p.cwd,\n  p.euid,\n  p.cmdline\nFROM\n  socket_events\
    \ se\n  LEFT JOIN processes p ON se.pid = p.pid\nWHERE\n  se.time > (strftime('%s',\
    \ 'now') -300)\n  AND family = 2 -- PF_INET\n  AND protocol = 1 -- ICMP\n  AND\
    \ p.name NOT IN ('ping')\n"
  interval: 300
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

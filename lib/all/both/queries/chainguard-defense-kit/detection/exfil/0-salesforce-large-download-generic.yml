- name: CDK - Salesforce Large Download Generic
  description: Returns a list of files likely exported from Salesforce
  query: "SELECT\n  file.path,\n  file.size,\n  datetime(file.btime, 'unixepoch')\
    \ AS file_created,\n  datetime(file.atime, 'unixepoch') AS file_accessed,\n  hash.sha256\n\
    FROM\n  file\n  LEFT JOIN hash ON file.path = hash.path\nWHERE\n  (\n    file.path\
    \ LIKE '/Users/%/Downloads/%-202%-%-%-%-%-%.xlsx'\n    OR file.path LIKE '/home/%/Downloads/%-202%-%-%-%-%-%.xlsx'\n\
    \    OR file.path LIKE '/Users/%/Downloads/WE_%.ZIP'\n    OR file.path LIKE '/home/%/Downloads/WE_%.ZIP'\n\
    \    OR file.path LIKE '/Users/%/Downloads/report17%.%'\n    OR file.path LIKE\
    \ '/home/%/Downloads/report17%.%'\n    OR file.path LIKE '/Users/%/Downloads/%/Cont%act.csv'\n\
    \    OR file.path LIKE '/home/%/Downloads/%/Cont%act.csv'\n  )\n  AND file.btime\
    \ > (strftime('%s', 'now') -86400)\n  AND file.size > 500000\nGROUP BY\n  file.path\n"
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

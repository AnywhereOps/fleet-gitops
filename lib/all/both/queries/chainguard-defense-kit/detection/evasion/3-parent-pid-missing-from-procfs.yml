- name: CDK - Parent Pid Missing From Procfs
  description: Find a process which has a parent that is not listed in the process
    table Works well for revealing boopkit, so long as boopkit has a child process.
  query: "SELECT\n  p.*,\n  hash.sha256,\n  GROUP_CONCAT(DISTINCT pof.path) AS open_files\n\
    FROM\n  processes p\n  LEFT JOIN hash ON p.path = hash.path\n  LEFT JOIN process_open_files\
    \ pof ON p.pid = pof.pid\nWHERE -- Prevent false positives by avoiding short-lived\
    \ commands\n  p.start_time < (strftime('%s', 'now') -300)\n  AND p.parent NOT\
    \ IN (\n    SELECT\n      pid\n    FROM\n      processes\n  )\n  AND p.parent\
    \ != 0\n  AND p.parent IS NOT NULL\nGROUP BY\n  p.pid\n"
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

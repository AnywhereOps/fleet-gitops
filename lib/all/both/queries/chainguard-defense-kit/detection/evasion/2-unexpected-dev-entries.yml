- name: CDK - Unexpected Dev Entries
  description: Find unexpected files in /dev
  query: "SELECT\n  file.path,\n  file.type,\n  file.size,\n  file.mtime,\n  file.uid,\n\
    \  file.ctime,\n  file.gid,\n  hash.sha256,\n  magic.data\nFROM\n  file\n  LEFT\
    \ JOIN hash ON file.path = hash.path\n  LEFT JOIN magic ON file.path = magic.path\n\
    WHERE\n  (\n    file.path LIKE '/dev/shm/%%'\n    OR file.path LIKE '/dev/.%'\n\
    \    OR file.path LIKE '/dev/.%/%'\n    OR file.path LIKE '/dev/%/.%'\n    OR\
    \ file.path LIKE '/dev/%%/.%/%'\n    OR file.path LIKE '/dev/mqueue/%%'\n  )\n\
    \  AND NOT (\n    file.uid > 499\n    AND (\n      file.path LIKE '/dev/shm/.com.google.%'\n\
    \      OR file.path LIKE '/dev/shm/.com.microsoft.Edge.%'\n      OR file.path\
    \ LIKE '/dev/shm/.org.chromium.%'\n      OR file.path LIKE '/dev/shm/aomshm.%'\n\
    \      OR file.path LIKE '/dev/shm/byobu-%'\n      OR file.path LIKE '/dev/shm/jack_db%'\n\
    \      OR file.path LIKE '/dev/shm/lsp-catalog-%.lock'\n      OR file.path LIKE\
    \ '/dev/shm/pulse-shm-%'\n      OR file.path LIKE '/dev/shm/sem.%autosave'\n \
    \     OR file.path LIKE '/dev/shm/shm-%-%-%'\n      OR file.path LIKE '/dev/shm/u1000-Shm%'\n\
    \      OR file.path LIKE '/dev/shm/u1000-Valve%'\n      OR file.path LIKE '/dev/shm/wayland.mozilla.%'\n\
    \      OR file.path LIKE '/dev/shm/CefRaster%'\n      OR file.path LIKE '/dev/shm/xapp-tmp-%'\n\
    \      OR file.path LIKE '/dev/mqueue/us.zoom.aom.globalmgr.%.rpc'\n    )\n  )\n\
    \  AND NOT (\n    file.size <= 32\n    AND file.path LIKE '/dev/shm/%'\n  )\n\
    \  AND file.path NOT LIKE '/dev/shm/flatpak-%'\n  AND file.path NOT LIKE '/dev/shm/libpod_rootless_lock_%'\n\
    \  AND file.path NOT LIKE '/dev/shm/lttng-ust-wait-%'\n  AND file.path NOT LIKE\
    \ '/dev/shm/sem.mp-%'\n  AND file.path NOT LIKE '%/../%'\n  AND file.path NOT\
    \ LIKE '%/./%'\n  AND file.path NOT IN (\n    '/dev/.mdadm/',\n    '/dev/shm/libpod_lock',\n\
    \    '/dev/shm/sem.camlock'\n  )\n"
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

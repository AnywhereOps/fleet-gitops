- name: CDK - Open Files
  description: Retrieves all the open files per process in the target system.
  query: "SELECT DISTINCT\n  pof.pid,\n  pof.path,\n  pof.fd,\n  p.name,\n  p.start_time,\n\
    \  p.euid,\n  p.parent,\n  p.uid,\n  p.cmdline\nFROM\n  process_open_files pof\n\
    \  LEFT JOIN processes p ON pof.pid = p.pid\nWHERE\n  pof.path NOT LIKE '/private/var/folders%'\n\
    \  AND pof.path NOT LIKE '/System/Library/%'\n  AND pof.path NOT IN ('/dev/null',\
    \ '/dev/urandom', '/dev/random');\n"
  interval: 3600
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

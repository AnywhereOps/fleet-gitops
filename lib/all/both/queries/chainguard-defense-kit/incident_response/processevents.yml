- name: CDK - Process Events
  description: Recently executed programs
  query: "SELECT\n  pe.*,\n  -- pe.cwd is often blank\n  p.cwd AS delayed_proc_cwd,\n\
    \  pp.cwd AS delayed_parent_cwd,\n  pp.path AS parent_path,\n  pp.name AS delayed_parent_name\n\
    FROM\n  process_events pe\n  LEFT JOIN processes p ON pe.pid = p.pid\n  LEFT JOIN\
    \ processes pp ON pe.parent = pp.pid\nWHERE\n  pe.time > (strftime('%s', 'now')\
    \ -600)\n  -- Filter out commands generated by osquery/kolide\n  AND pe.cmdline\
    \ NOT LIKE '/bin/ps -x -o%'\n  AND parent_path NOT LIKE '/usr/local/kolide-k2/%/launcher'\n\
    GROUP BY\n  pe.pid,\n  pe.eid\n"
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

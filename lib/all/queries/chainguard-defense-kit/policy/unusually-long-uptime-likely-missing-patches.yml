---
apiVersion: v1
kind: query
spec:
  name: CDK - Unusually Long Uptime Likely Missing Patches
  description: Indicative of a machine that probably needs a reboot for operating-system patches
  query: |
    SELECT
      os_version.name AS os_name,
      os_version.version AS os_version,
      kernel_info.version AS kernel,
      days AS uptime_days
    FROM
      kernel_info,
      os_version,
      uptime
    WHERE
      uptime.days > 89;
  interval: 3600
  logging: snapshot
  observer_can_run: true
  automations_enabled: false
  discard_data: false

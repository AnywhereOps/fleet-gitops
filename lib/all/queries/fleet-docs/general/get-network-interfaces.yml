---
apiVersion: v1
kind: query
spec:
  name: Get network interfaces
  platform: darwin, linux, windows
  description: Network interfaces MAC address
  query: SELECT a.interface, a.address, d.mac FROM interface_addresses a JOIN interface_details d USING (interface) WHERE address not in ('127.0.0.1', '::1');
  powershell: |-
    $ipInfo = Get-NetIPAddress -ErrorAction SilentlyContinue | Where-Object { $_.IPAddress -notin ('127.0.0.1','::1') } $adapters = Get-NetAdapter -ErrorAction SilentlyContinue | Select-Object ifIndex, MacAddress $results = foreach ($ip in $ipInfo) {
        $adapter = $adapters | Where-Object { $_.ifIndex -eq $ip.InterfaceIndex } | Select-Object -First 1
        [PSCustomObject]@{
            interface = $ip.InterfaceAlias
            address   = $ip.IPAddress
            mac       = if ($adapter) { $adapter.MacAddress } else { 'N/A' }
        }
    } $results | Format-Table -AutoSize
  bash: (echo "interface,address,mac"; for iface in $(ifconfig -l); do mac=$(ifconfig "$iface" | awk '/ether/{print $2; exit}'); for ip in $(ifconfig "$iface" | awk '/inet /{if ($2!="127.0.0.1") print $2}
    /inet6 /{if ($2!="::1") print $2}'); do echo "$iface,$ip,$mac"; done; done)
  purpose: informational
  tags: hunting, inventory
  contributors: anelshaer

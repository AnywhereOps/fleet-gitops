- name: CDK - Tiny Executable
  description: Unusually small programs (state-based)
  query: "SELECT\n  p.pid,\n  p.path,\n  p.cmdline,\n  file.size,\n  p.start_time,\n\
    \  file.mode,\n  file.type,\n  p.cwd,\n  p.euid,\n  p.parent,\n  pp.path AS parent_path,\n\
    \  pp.name AS parent_name,\n  pp.cmdline AS parent_cmdline,\n  pp.euid AS parent_euid,\n\
    \  hash.sha256 AS parent_sha256\nFROM\n  processes p\n  LEFT JOIN file ON p.path\
    \ = file.path\n  LEFT JOIN processes pp ON p.parent = pp.pid\n  LEFT JOIN hash\
    \ ON pp.path = hash.path\nWHERE\n  file.size > 0\n  AND file.size < 10000\n  AND\
    \ NOT file.path LIKE '/home/%/.local/share/Steam/steamapps/%'\n  AND NOT file.path\
    \ LIKE '/home/%/.local/share/Steam/ubuntu%'\n  AND NOT file.path LIKE '/home/%/.zsh/completion'\n\
    \  AND NOT file.path LIKE '/Users/%/.zsh/completion'\n  AND NOT file.path IN (\n\
    \    '/',\n    '/usr/bin/ruby',\n    '/Applications/OpenOffice.app/Contents/MacOS/soffice'\n\
    \  )\n  AND NOT (\n    file.path = '/sbin/ldconfig'\n    AND pp.euid = 1000\n\
    \  )\n  AND NOT (\n    file.path LIKE '/home/%/.ape-%'\n    AND pp.euid = 1000\n\
    \  )\n"
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

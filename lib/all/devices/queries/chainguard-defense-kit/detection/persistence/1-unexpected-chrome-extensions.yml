- name: CDK - Unexpected Chrome Extensions
  description: Highlight chrome extensions with wide-ranging permissions that are
    not part of your whitelist
  query: "SELECT\n  name,\n  profile,\n  chrome_extensions.description AS 'descr',\n\
    \  persistent AS persists,\n  CONCAT (\n    \"https://chromewebstore.google.com/detail/extension/\"\
    ,\n    identifier\n  ) AS ext_url,\n  author,\n  chrome_extensions.path,\n  referenced\
    \ AS in_config,\n  file.ctime,\n  file.btime,\n  file.mtime,\n  from_webstore\
    \ AS in_store,\n  TRIM(CAST(permissions AS text)) AS perms,\n  state AS 'enabled',\n\
    \  CONCAT (\n    from_webstore,\n    ',',\n    author,\n    ',',\n    name,\n\
    \    ',',\n    identifier\n  ) AS exception_key,\n  hash.sha256\nFROM\n  users\n\
    \  CROSS JOIN chrome_extensions USING (uid)\n  LEFT JOIN file ON chrome_extensions.path\
    \ = file.path\n  LEFT JOIN hash ON chrome_extensions.path = hash.path\nWHERE\n\
    \  state = 1\n  AND (\n    (\n      from_webstore != 'true'\n      AND (\n   \
    \     perms LIKE '%bookmarks%'\n        OR perms LIKE \"%http%\"\n        OR perms\
    \ LIKE \"%nativeMessaging%\"\n        OR perms LIKE \"%pageCapture%\"\n      \
    \  OR perms LIKE \"%session%\" -- Sigstore\n        OR perms LIKE \"%webRequest%\"\
    \n      )\n    )\n    -- Can make requests and see interesting information\n \
    \   OR (\n      perms like '%webRequest%'\n      OR perms LIKE '%dns%'\n     \
    \ AND (\n        perms LIKE '%://*/%'\n        OR perms LIKE '%<all_urls>%'\n\
    \        OR perms LIKE '%blockchain%'\n        OR perms LIKE '%clipboardRead%'\n\
    \        OR perms LIKE '%coinbase%'\n        OR perms LIKE '%cookies%'\n     \
    \   OR perms LIKE '%github.com%'\n        OR perms LIKE '%google.com%'\n     \
    \   OR perms LIKE '%pageCapture%'\n        OR perms LIKE '%privacy%'\n       \
    \ OR perms LIKE '%tabCapture%'\n        OR perms LIKE '%tabs%'\n        OR perms\
    \ LIKE '%webNavigation%'\n      )\n    )\n    -- Unusual permissions\n    OR perms\
    \ LIKE \"%contentSettings%\"\n    OR perms LIKE \"%history%\"\n    OR perms LIKE\
    \ \"%management%\"\n    OR perms LIKE \"%nativeMessaging%\"\n    OR perms LIKE\
    \ \"%proxy%\"\n    OR perms LIKE \"%vpnProvider%\"\n    OR perms LIKE \"%webAuthenticationProxy%\"\
    \n    OR perms LIKE '%debugger%'\n    OR perms LIKE '%declarativeNetRequestFeedback%'\n\
    \    OR perms LIKE '%desktopCapture%'\n  )\n  AND NOT exception_key IN (\n   \
    \ \"true,GEN Digital Inc.,I don't care about cookies,fihnjjcciajhdojfnbdddfaoknhalnja\"\
    ,\n    \"true,OhMyGuus and Community (originally Daniel Kladnik),I still don't\
    \ care about cookies,edibdbjcniadpccecjdfdjjppcpchdlm\",\n    'false,eff.software.projects@gmail.com,Privacy\
    \ Badger,mkejgcgkdlddbggjhhflekkondicpnop',\n    'false,privacybadger-owner@eff.org,Privacy\
    \ Badger,mkejgcgkdlddbggjhhflekkondicpnop',\n    'true,,Adblock for Youtube™,cmedhionkhpnakcndndgjdbohmhepckk',\n\
    \    'true,,Adobe Acrobat: PDF edit, convert, sign tools,efaidnbmnnnibpcajpcglclefindmkaj',\n\
    \    'true,,Allow CORS: Access-Control-Allow-Origin,lhobafahddgcelffkeicbaginigeejlf',\n\
    \    'true,,Amplitude Event Explorer,acehfjhnmhbmgkedjmjlobpgdicnhkbp',\n    'true,,Application\
    \ Launcher For Drive (by Google),lmjegmlicamnimmfhcmpkclmigmmcbeh',\n    'true,,Awesome\
    \ Screen Recorder & Screenshot,nlipoenfbbikpbjkfpfillcgkoblgpmj',\n    'true,,axe\
    \ DevTools - Web Accessibility Testing,lhdoppojpmngadmnindnejefpokejbdd',\n  \
    \  'true,,Boomerang for Gmail,mdanidgdpmkimeiiojknlnekblgmpdll',\n    'true,,Capital\
    \ One Shopping: Save Now,nenlahapcbofgnanklpelkaejcehkggg',\n    'true,,Chrome\
    \ Capture - screenshot & GIF,ggaabchcecdbomdcnbahdfddfikjmphe',\n    'true,,Chrome\
    \ Remote Desktop,inomeogfingihgjfjlpeplalcfajhgai',\n    'true,,Cisco Umbrella\
    \ Chromebook client (Ext),jcdhmojfecjfmbdpchihbeilohgnbdci',\n    'true,,Cisco\
    \ Webex Extension,jlhmfgmfgeifomenelglieieghnjghma',\n    'true,,Copper CRM for\
    \ Gmail,hpfmedbkgaakgagknibnonpkimkibkla',\n    'true,,Coupert - Automatic Coupon\
    \ Finder & Cashback,mfidniedemcgceagapgdekdbmanojomk',\n    'true,,CSP Evaluator,fjohamlofnakbnbfjkohkbdigoodcejf',\n\
    \    'true,,DuckDuckGo Privacy Essentials,bkdgflcldnnnapblkhphbgpggdiikppg',\n\
    \    'true,,DuckDuckGo Search & Tracker Protection,bkdgflcldnnnapblkhphbgpggdiikppg',\n\
    \    'true,,EditThisCookie,fngmhnnpilhplaeedifhccceomclgfbg',\n    'true,,Endpoint\
    \ Verification,callobklhcbilhphinckomhgkigmfocg',\n    'true,,Gem,bnbpceglddpnehbopmdjegpfinikcaoh',\n\
    \    'true,,Go Links,gojgbkejhelijlkgpmlbbkklljgmfljj',\n    'true,,Google Keep\
    \ - Notes and Lists,hmjkmjkepdijhoojdojkdfohbdgmmhki',\n    'true,,GoToTraining\
    \ Screensharing,copcmbdalilphnaiajfmonkegedhkndd',\n    'true,,Greenhouse Recruiting\
    \ Chrome extension,naooopefdfeangnkgmjpklgblnfmbaea',\n    'true,,Hippo Video:\
    \ Video and Screen Recorder,cijidiollmnkegoghpfobabpecdkeiah',\n    'true,,Honey:\
    \ Automatic Coupons & Rewards,bmnlcjabgnpnenekpadlanbbkooimhnj',\n    'true,,HubSpot\
    \ Sales,oiiaigjnkhngdbnoookogelabohpglmd',\n    'true,,iCloud Bookmarks,fkepacicchenbjecpbpbclokcabebhah',\n\
    \    'true,,iCloud Passwords,pejdijmoenmkgeppbflobdenhhabjlaj',\n    'true,,Kagi\
    \ Privacy Pass,mendokngpagmkejfpmeellpppjgbpdaj',\n    'true,,Kagi Search,cdglnehniifkbagbbombnjghhcihifij',\n\
    \    'true,,Live Stream Downloader,looepbdllpjgdmkpdcdffhdbmpbcfekj',\n    'true,,Loom\
    \ – Screen Recorder & Screen Capture,liecbddmkiiihnedobmlmillhodjkdmb',\n    'true,,Media\
    \ Hint,akipcefbjlmpbcejgdaopmmidpnjlhnb',\n    'true,,Mettl Tests : Enable Screen\
    \ Sharing,hkjemkcbndldepdbnbdnibeppofoooio',\n    'true,,Microsoft Single Sign\
    \ On,ppnbnpeolgkicgegkbkbjmhlideopiji',\n    'true,,Moesif Origin/CORS Changer\
    \ & API Logger,digfbfaphojjndkpccljibejjbppifbc',\n    'true,,Newsletter Creator\
    \ for Gmail - Flashissue,cihaednhfbocfdiflmpccekcmjepcnmb',\n    'true,,Nooks,kbbdibmbjngifdgbmlleelghocpeimhe',\n\
    \    'true,,NordVPN - VPN proxy for privacy and security,fjoaledfpmneenckfbpdfhkmimnjocfa',\n\
    \    'true,,NoScript,doojmbjmlfjjnbmnoijecmcbfeoakpjm',\n    'true,,Okta Browser\
    \ Plugin,glnpjglilkicbckjpbgcfkogebgllemb',\n    'true,,OneLogin for Google Chrome,ioalpmibngobedobkmbhgmadaphocjdn',\n\
    \    'true,,Outreach Optimization on LinkedIn & Gmail,ngeodglgpmplepchhghijjncnikifaed',\n\
    \    'true,,Page Analytics (by Google),fnbdnhhicmebfgdgglcdacdapkcihcoh',\n  \
    \  'true,,Poshmark | PosherVA,ofacfijogapplfgkoolmdojoieiemihl',\n    'true,,Privacy\
    \ Badger,pkehgijcmpdhfbdbbnkijodmdjhbjlgp',\n    'true,,ProctorU,goobgennebinldhonaajgafidboenlkl',\n\
    \    'true,,Ramp for Chrome,idefohglmnkliiadgfofeokcpjobdeik',\n    'true,,Reddit\
    \ Pixel Helper,ebgpcjlgganlidigifggjjiglghjnjcj',\n    'true,,Reflect,kljfphapkgkjaiiddfmfpbdmeaplojge',\n\
    \    'true,,Salesforce,jjghhkepijgakdammjldcbnjehfkfmha',\n    'true,,SalesLoft\
    \ Connect - Legacy,cffgjgigjfgjkfdopbobbdadaelbhepo',\n    'true,,Save to Google\
    \ Drive,gmbmikajjgmnabiglmofipeabaddhgne',\n    'true,,Screen Recorder,hniebljpgcogalllopnjokppmgbhaden',\n\
    \    'true,,Screenshot & Screen Video Record by Screeny,djekgpcemgcnfkjldcclcpcjhemofcib',\n\
    \    'true,,Secure Browser - Online Proctoring Extension,aeindiojndlokkemcgakgpgbcmgonifn',\n\
    \    'true,,Selenium IDE,mooikfkahbdckldjjndioackbalphokd',\n    'true,,Soapbox\
    \ —  Video Recorder,lmepjnndgdhcgphilomlfekmgnnmngbi',\n    'true,,Solitaire,lkbhppfbabandkdmgjmifahoabeodiep',\n\
    \    'true,,Surfshark VPN Extension,ailoabdmgclmfmhdagmlohpjlbpffblp',\n    'true,,Talend\
    \ API Tester - Free Edition,aejoelaoggembcahagimdiliamlcdmfm',\n    'true,,Tamper\
    \ Chrome (extension),hifhgpdkfodlpnlmlnmhchnkepplebkb',\n    'true,,Tampermonkey,dhdgffkkebhmkfjojejmpbldmpobfkfo',\n\
    \    'true,,TextExpander: Keyboard Shortcuts & Templates,mmfhhfjhpadoefoaahomoakamjcfcoil',\n\
    \    'true,,Touch VPN - Secure and unlimited VPN proxy,bihmplhobchoageeokmgbdihknkjbknd',\n\
    \    'true,,uBlock,epcnnfbjfcgphgdmggkamkmgojdagdnn',\n    'true,,Video Downloader\
    \ PLUS,njgehaondchbmjmajphnhlojfnbfokng',\n    'true,,Video Downloader Professional,elicpjhcidhpjomhibiffojpinpmmpil',\n\
    \    'true,,Vimium,dbepggeogbaibhgnhhndojpepiihcmeb',\n    'true,,Web Developer,bfbameneiokkgbdmiekhjnmfkcnldhhm',\n\
    \    'true,,WhatRuns,cmkdbmfndkfgebldhnkbfhlneefdaaip',\n    'true,,Wistia Video\
    \ Downloader,acbiaofoeebeinacmcknopaikmecdehl',\n    'true,,Yesware Sales Engagement,gkjnkapjmjfpipfcccnjbjcbgdnahpjp',\n\
    \    'true,,Zoom,hmbjbjdpkobdjplfobhljndfdfdipjhg',\n    'true,,Zotero Connector,ekhagklcjbdpajgpjgmbionohlpdbjgc',\n\
    \    'true,Adblock, Inc.,AdBlock — block ads across the web,gighmmpiobklfepjocnamgkkbiglidom',\n\
    \    'true,Adguard Software Ltd,AdGuard AdBlocker,bgnkhhnnamicmpeenaelnjfhikgbkllg',\n\
    \    'true,AgileBits,1Password Nightly – Password Manager,gejiddohjgogedgjnonbofjigllpkmbf',\n\
    \    'true,AgileBits,1Password – Password Manager,aeblfdkhhhdcdjpifhhbdiojplfjncoa',\n\
    \    'true,Aura,Aura,fjbgpaheigpmkbdkdfghmkbnkpeofmhh',\n    'true,AwardWallet\
    \ LLC,AwardWallet,lppkddfmnlpjbojooindbmcokchjgbib',\n    'true,Benjamin Hollis,JSONView,gmegofmjomhknnokphhckolhcffdaihd',\n\
    \    'true,BetterLogic <Dev@betterlogic>,Better History | Blacklist Mode,egehpkpgpgooebopjihjmnpejnjafefi',\n\
    \    'true,BetterLogic <Dev@betterlogic>,Better History | Manage, Export & Delete\
    \ History,egehpkpgpgooebopjihjmnpejnjafefi',\n    'true,Bitwarden Inc.,Bitwarden\
    \ - Free Password Manager,nngceckbapebfimnlniiiahkandclblb',\n    'true,Bitwarden\
    \ Inc.,Bitwarden Password Manager,nngceckbapebfimnlniiiahkandclblb',\n    'true,Cartera,American\
    \ Airlines AAdvantage® eShopping℠,dcdiajifnnbipfljbggcbbheipfdmgpo',\n    'true,Cartera,Delta\
    \ Air Lines SkyMiles® Shopping℠,mkgbnjpecbelajilbdeokhehjfbeglgf',\n    'true,Cartera,United\
    \ Airlines MileagePlus Shopping℠,apcjkhjbhapedgbekhlhdkidpohpkfne',\n    'true,ExpressVPN,ExpressVPN:\
    \ VPN proxy for a better internet,fgddmllnllkalaagkghckoinaemmogpe',\n    'true,eyeo\
    \ GmbH,Adblock Plus - free ad blocker,cfhdojbkjhnklbpkdaibdccddilifddb',\n   \
    \ 'true,François Duprat,Mobile simulator - responsive testing tool,ckejmhbmlajgoklhgbapkiccekfoccmk',\n\
    \    'true,Ghostery,Ghostery Tracker & Ad Blocker - Privacy AdBlock,mlomiejdfkolichcflejclcbmpeaniij',\n\
    \    'true,GLIDER,Glider Proctoring,dcnidakmkbkbohdaelljpgdhmbbpbdbg',\n    'true,GZ\
    \ systems Ltd.,PureVPN Proxy - Best VPN for Chrome,bfidboloedlamgdmenmlbipfnccokknp',\n\
    \    'true,https://metamask.io,MetaMask,nkbihfbeogaeaoehlefnkodbefgpgknn',\n \
    \   'true,Kai Uwe Broulik <kde@privat.broulik.de>,Plasma Integration,cimiefiiaegbelhefglklhhakcgmhkai',\n\
    \    'true,Keepa GmbH,Keepa - Amazon Price Tracker,neebplgakaahbhdphmkckjjcegoiijjo',\n\
    \    'true,KeePassXC Team,KeePassXC-Browser,oboonakemofpalcgghocfoadofidjkkk',\n\
    \    'true,Keeper Security, Inc.,Keeper® Password Manager & Digital Vault,bfogiafebfohielmmehodmfbbebbbpei',\n\
    \    'true,LastPass,LastPass: Free Password Manager,hdokiejnpimakedhajhdlcegeplioahd',\n\
    \    'true,Lydian AI <_start@lydian.ai>,Ghostwrite: ChatGPT Email Assistant,fbjnnjochaopepfjpngghafgnafebkjh',\n\
    \    'true,Microsoft Corporation,Microsoft Autofill,fiedbfgcleddlbcmgdigjgdfcggjcion',\n\
    \    'true,modhader@,ModHeader - Modify HTTP headers,idgpnmonknjnojddfkpgkljpfnnfcklj',\n\
    \    'true,Olav Morken, Jaime Perez, Thijs Kinkhorst, Jan Köhler, Tim van Dijen,SAML-tracer,mpdajninpobndbfcldcmbpnnbhibjmch',\n\
    \    'true,Opera Software AS,Rich Hints Agent,enegjkbbakeegngfapepobipndnebkdk',\n\
    \    'true,Opera,Cashback Assistant,ompjkhnkeoicimmaehlcmgmpghobbjoj',\n    'true,Quantier,\
    \ LLC,Vim for Google Docs™,aphmodfjbhofkpibocbggkdfnpbpjmpp',\n    'true,Rakuten,Rakuten:\
    \ Get Cash Back For Shopping,chhjbpecpncaggjpdakmflnfcopglcmi',\n    'true,Raymond\
    \ Hill & contributors,uBlock Origin,cjpalhdlnbpafiamejdnhcphjbkeiagm',\n    'true,Reddit\
    \ Enhancement Suite contributors,Reddit Enhancement Suite,kbmfpngjjgdllneeigpgjifpgocmfgmb',\n\
    \    'true,Symantec Corporation,Norton Password Manager,admmjipmmciaobhojoghlmleefbicajg',\n\
    \    'true,Thomas Rientjes,Decentraleyes,ldpochfccmkkmhdbclfhpagapcfdljkj',\n\
    \    'true,Wappalyzer,Wappalyzer - Technology profiler,gppongmhjkpfnbhagpmjfkannfbllamg',\n\
    \    'true,Yuri Konotopov <ykonotopov@gnome.org>,GNOME Shell integration,gphhapmejobijbbhgpjhcjognlahblep',\n\
    \    'true,Zinlab <sebastian@Zinlab>,Better History,egehpkpgpgooebopjihjmnpejnjafefi'\n\
    \  )\n  AND NOT (\n    exception_key IN (\n      'false,,Onion Browser Button,joijkphhgidknnmmaabfgjhjmgjiepia',\n\
    \      'false,AgileBits,1Password – Password Manager,dppgmdbiimibapkepcbdbmkaabgiofem'\n\
    \    )\n    AND chrome_extensions.path LIKE '%/Microsoft Edge/%'\n  )\nGROUP BY\n\
    \  exception_key\n"
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

- name: CDK - Files Recently Written
  description: Returns a list of recently written files
  query: "SELECT\n  *\nFROM\n  file\nWHERE\n  (\n    path LIKE \"/var/tmp/%\"\n  \
    \  OR path LIKE \"/var/tmp/%/%\"\n    OR path LIKE \"/Applications/%\"\n    OR\
    \ path LIKE \"/Applications/%/%\"\n    OR path LIKE \"/home/%/%\"\n    OR path\
    \ LIKE \"/home/%/.%/%\"\n    OR path LIKE \"/home/%/.%/%/%\"\n    OR path LIKE\
    \ \"/home/%/.config/%\"\n    OR path LIKE \"/home/%/.config/%/%\"\n    OR path\
    \ LIKE \"/Library/%/%\"\n    OR path LIKE \"/Library/.%\"\n    OR path LIKE \"\
    /Library/Application Support/%\"\n    OR path LIKE \"/Library/Application Support/.%\"\
    \n    OR path LIKE \"/tmp/%\"\n    OR path LIKE \"/tmp/%/%\"\n    OR path LIKE\
    \ \"/tmp/.%/%%\"\n    OR path LIKE \"/Users/%/%\"\n    OR path LIKE \"/Users/%/%/%\"\
    \n    OR path LIKE \"/Users/%/.%/%\"\n    OR path LIKE \"/Users/%/.%/%/%\"\n \
    \   OR path LIKE \"/Users/Library/%\"\n    OR path LIKE \"/Users/Library/%/%\"\
    \n    OR path LIKE \"/Users/Library/.%\"\n    OR path LIKE \"/Users/Library/Application\
    \ Support/%\"\n    OR path LIKE \"/Users/Library/Application Support/%/%\"\n \
    \   OR path LIKE \"/Users/Library/Application Support/.%\"\n    OR path LIKE \"\
    /var/%\"\n    OR path LIKE \"/var/%/%\"\n  )\n  AND (\n    mtime > (strftime('%s',\
    \ 'now') -3600)\n    OR (\n      atime > (strftime('%s', 'now') -3600)\n     \
    \ AND file.type = \"regular\"\n    )\n    OR ctime > (strftime('%s', 'now') -3600)\n\
    \    OR btime > (strftime('%s', 'now') -3600)\n  )\n  AND NOT path LIKE \"%/../%\"\
    \nGROUP BY\n  inode;\n"
  interval: 3600
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

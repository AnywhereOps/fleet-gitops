- name: CDK - Unexpected Etc Hosts
  description: Unexpected /etc/hosts entries
  query: "SELECT\n  *\nFROM\n  etc_hosts\nWHERE\n  hostnames NOT IN (\n    'ip6-allnodes',\n\
    \    'ip6-allrouters',\n    'kubernetes',\n    'localhost ip6-localhost ip6-loopback',\n\
    \    'localhost localhost.localdomain localhost4 localhost4.localdomain4',\n \
    \   'localhost'\n  )\n  AND address NOT IN (\n    '::1',\n    'ff02::1',\n   \
    \ 'ff02::2',\n    '255.255.255.255',\n    'fe00::0',\n    'ff00::0'\n  )\n  AND\
    \ address NOT LIKE '127.%'\n  AND address NOT LIKE '172.%'\n  AND address NOT\
    \ LIKE '192.168.%'\n  AND address NOT LIKE '10.%'\n  AND hostnames NOT LIKE '%.%-%.%.dev'\n\
    \  AND hostnames NOT LIKE '%.internal'\n  AND hostnames NOT LIKE '%.local'\n \
    \ AND hostnames NOT LIKE '%.svc'\n  AND hostnames NOT LIKE '%.test'\n  AND hostnames\
    \ NOT LIKE '%.wtf'\n  AND hostnames NOT LIKE '%k8s%'\n  AND hostnames NOT LIKE\
    \ '%local%'\n  AND hostnames NOT LIKE 'ip6-%'\n  AND hostnames NOT LIKE 'localhost.%'\n\
    \  AND hostnames NOT LIKE \"%.cloud\"\n  AND hostnames NOT LIKE \"%.example.com\"\
    \n"
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

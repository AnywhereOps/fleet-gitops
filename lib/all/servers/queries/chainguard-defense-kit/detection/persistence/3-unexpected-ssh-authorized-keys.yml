- name: CDK - Unexpected Ssh Authorized Keys
  description: Find unexpected SSH authorized keys
  query: "SELECT\n  file.path,\n  file.uid,\n  file.gid,\n  file.atime,\n  file.mtime,\n\
    \  file.ctime,\n  file.size,\n  hash.sha256,\n  users.username,\n  users.uid AS\
    \ u_uid\nFROM\n  users\n  JOIN file ON file.path = users.directory || \"/.ssh/authorized_keys\"\
    \n  JOIN hash ON file.path = hash.path\nWHERE\n  file.size > 0\n  AND (\n    file.uid\
    \ != u_uid\n    OR file.uid < 500\n    OR (\n      file.path NOT LIKE '/home/%'\n\
    \      AND file.path NOT LIKE '/Users/%'\n    )\n  )\n"
  interval: 3600
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

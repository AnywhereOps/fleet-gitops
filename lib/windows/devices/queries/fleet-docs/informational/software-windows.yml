- name: Software (Windows)
  description: Gathers information about software installed on a device running Windows.
  query: "WITH cached_users AS (WITH cached_groups AS (select * from groups)\n SELECT\
    \ uid, uuid, username, type, groupname, shell\n FROM users LEFT JOIN cached_groups\
    \ USING (gid)\n WHERE type <> 'special' AND shell NOT LIKE '%/false' AND shell\
    \ NOT LIKE '%/nologin' AND shell NOT LIKE '%/shutdown' AND shell NOT LIKE '%/halt'\
    \ AND username NOT LIKE '%$' AND username NOT LIKE '\\_%' ESCAPE '\\' AND NOT\
    \ (username = 'sync' AND shell ='/bin/sync' AND directory <> ''))\nSELECT\n  name\
    \ AS name,\n  version AS version,\n  '' AS extension_id,\n  '' AS browser,\n \
    \ 'programs' AS source,\n  publisher AS vendor,\n  install_location AS installed_path\n\
    FROM programs\nUNION\nSELECT\n  name AS name,\n  version AS version,\n  '' AS\
    \ extension_id,\n  '' AS browser,\n  'ie_extensions' AS source,\n  '' AS vendor,\n\
    \  path AS installed_path\nFROM ie_extensions\nUNION\nSELECT\n  name AS name,\n\
    \  version AS version,\n  identifier AS extension_id,\n  browser_type AS browser,\n\
    \  'chrome_extensions' AS source,\n  '' AS vendor,\n  path AS installed_path\n\
    FROM cached_users CROSS JOIN chrome_extensions USING (uid)\nUNION\nSELECT\n  name\
    \ AS name,\n  version AS version,\n  identifier AS extension_id,\n  'firefox'\
    \ AS browser,\n  'firefox_addons' AS source,\n  '' AS vendor,\n  path AS installed_path\n\
    FROM cached_users CROSS JOIN firefox_addons USING (uid)\nUNION\nSELECT\n  name\
    \ AS name,\n  version AS version,\n  '' AS extension_id,\n  '' AS browser,\n \
    \ 'chocolatey_packages' AS source,\n  '' AS vendor,\n  path AS installed_path\n\
    FROM chocolatey_packages\n"
  platform: windows

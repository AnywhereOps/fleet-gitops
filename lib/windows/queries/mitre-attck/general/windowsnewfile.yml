---
apiVersion: v1
kind: query
spec:
  name: windows_new_file
  platform: windows
  description: Check suspicious file creation under c:\windows - ATT&CK T1034,T1074,T1044
  query: SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime,
    'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\Windows\%' and type='regular';
  interval: 1800
  removed: false

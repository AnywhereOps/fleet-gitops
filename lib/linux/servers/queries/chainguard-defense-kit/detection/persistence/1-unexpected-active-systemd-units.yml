- name: CDK - Unexpected Active Systemd Units
  description: Unexpected systemd units, may be evidence of persistence
  query: "SELECT --  description AS 'desc',\n  fragment_path,\n  MAX(user, 'root')\
    \ AS effective_user,\n  following,\n  hash.sha256,\n  file.ctime,\n  file.size,\n\
    \  CONCAT (id, ',', description, ',', user) AS exception_key\nFROM\n  systemd_units\n\
    \  LEFT JOIN hash ON systemd_units.fragment_path = hash.path\n  LEFT JOIN file\
    \ ON systemd_units.fragment_path = file.path\nWHERE\n  active_state != 'inactive'\n\
    \  AND sub_state != 'plugged'\n  AND sub_state != 'mounted'\n  AND file.filename\
    \ != ''\n  -- Don't care about logical groupings.\n  AND NOT file.filename LIKE\
    \ '%.target'\n  AND NOT fragment_path = '/usr/lib/systemd/system/systemd-fsck@.service'\n\
    \  -- All of these are known good exceptions in known good paths\n  AND NOT (\n\
    \    (\n      -- Only allow fragment paths in known good directories\n      fragment_path\
    \ LIKE '/etc/systemd/system/%'\n      OR fragment_path LIKE '/lib/systemd/system/%'\n\
    \      OR fragment_path LIKE '/run/systemd/generator.late/%.service'\n      OR\
    \ fragment_path LIKE '/run/systemd/generator/%'\n      OR fragment_path LIKE '/run/systemd/transient/%'\n\
    \      OR fragment_path LIKE '/usr/lib/systemd/system/%'\n    )\n    AND (\n \
    \     exception_key IN (\n        '-.slice,Root Slice,',\n        'abrt-journal-core.service,ABRT\
    \ coredumpctl message creator,',\n        'abrt-journal-core.service,Creates ABRT\
    \ problems from coredumpctl messages,',\n        'abrt-oops.service,ABRT kernel\
    \ log watcher,',\n        'abrt-xorg.service,ABRT Xorg log watcher,',\n      \
    \  'abrtd.service,ABRT Automated Bug Reporting Tool,',\n        'abrtd.service,ABRT\
    \ Daemon,',\n        'accounts-daemon.service,Accounts Service,',\n        'acpid.path,ACPI\
    \ Events Check,',\n        'acpid.service,ACPI Daemon,',\n        'acpid.service,ACPI\
    \ event daemon,',\n        'acpid.socket,ACPID Listen Socket,',\n        'akmods.service,Builds\
    \ and install new kmods from akmod packages,',\n        'alsa-restore.service,Save/Restore\
    \ Sound Card State,',\n        'alsa-state.service,Manage Sound Card State (restore\
    \ and store),',\n        'alsa-store.service,Store Sound Card State,',\n     \
    \   'anacron.service,Run anacron jobs,',\n        'anacron.timer,Trigger anacron\
    \ every hour,',\n        'apache-htcacheclean.service,Disk Cache Cleaning Daemon\
    \ for Apache HTTP Server,www-data',\n        'apache2.service,The Apache HTTP\
    \ Server,',\n        'apcupsd.service,APC UPS Power Control Daemon for Linux,',\n\
    \        'apparmor.service,Load AppArmor profiles,',\n        'apport-autoreport.path,Process\
    \ error reports when automatic reporting is enabled (file watch),',\n        'apport-autoreport.service,Process\
    \ error reports when automatic reporting is enabled,',\n        'apport-autoreport.timer,Process\
    \ error reports when automatic reporting is enabled (timer based),',\n       \
    \ 'apport.service,automatic crash report generation,',\n        'apport.service,LSB:\
    \ automatic crash report generation,',\n        'apt-daily-upgrade.timer,Daily\
    \ apt upgrade and clean activities,',\n        'apt-daily.service,Daily apt download\
    \ activities,',\n        'apt-daily.timer,Daily apt download activities,',\n \
    \       'archlinux-keyring-wkd-sync.service,Refresh existing keys of archlinux-keyring,',\n\
    \        'archlinux-keyring-wkd-sync.timer,Refresh existing PGP keys of archlinux-keyring\
    \ regularly,',\n        'atd.service,Deferred execution scheduler,',\n       \
    \ 'atop-rotate.timer,Daily atop restart,',\n        'atop.service,Atop advanced\
    \ performance monitor,',\n        'atopacct.service,Atop process accounting daemon,',\n\
    \        'audit.service,Kernel Auditing,',\n        'auditd.service,Security Audit\
    \ Logging Service,',\n        'auditd.service,Security Auditing Service,',\n \
    \       'augenrules.service,auditd rules generation,',\n        'avahi-daemon.service,Avahi\
    \ mDNS/DNS-SD Stack,',\n        'avahi-daemon.socket,Avahi mDNS/DNS-SD Stack Activation\
    \ Socket,',\n        'backup-rpmdb.timer,Backup of RPM database,',\n        'backup-sysconfig.timer,Backup\
    \ of /etc/sysconfig,',\n        'bazzite-hardware-setup.service,Configure Bazzite\
    \ for current hardware,',\n        'binfmt-support.service,Enable support for\
    \ additional executable binary formats,',\n        'blk-availability.service,Availability\
    \ of block devices,',\n        'bluetooth.service,Bluetooth service,',\n     \
    \   'bootc-status-updated.path,Monitor bootc for status changes,',\n        'bolt.service,Thunderbolt\
    \ system service,',\n        'bootloader-update.service,Update bootloader on boot,',\n\
    \        'bootupd.socket,bootupd.socket,',\n        'brew-update.service,Auto\
    \ update brew for mutable brew installs,1000',\n        'brew-update.timer,Timer\
    \ for brew update for mutable brew,',\n        'brew-upgrade.service,Upgrade Brew\
    \ packages,1000',\n        'brew-upgrade.timer,Timer for brew upgrade for on image\
    \ brew,',\n        'btrfs-dedup@var-home.timer,Weekly Btrfs deduplication on /var/home,',\n\
    \        'ca-certificates.path,Watch for changes in CA certificates,',\n     \
    \   'check-battery.timer,Check if mainboard battery is Ok,',\n        'chrony.service,chrony,\
    \ an NTP client/server',\n        'chronyd.service,NTP client/server,',\n    \
    \    'cloud-config.service,Apply the settings specified in cloud-config,',\n \
    \       'cloud-final.service,Execute cloud user/final scripts,',\n        'cloud-init-hotplugd.socket,cloud-init\
    \ hotplug hook socket,',\n        'cloud-init-local.service,Initial cloud-init\
    \ job (pre-networking),',\n        'cloud-init.service,Initial cloud-init job\
    \ (metadata service crawler),',\n        'colord.service,Manage, Install and Generate\
    \ Color Profiles,colord',\n        'com.system76.PowerDaemon.service,System76\
    \ Power Daemon,',\n        'com.system76.Scheduler.service,Automatically configure\
    \ CPU scheduler for responsiveness on AC,',\n        'console-setup.service,Set\
    \ console font and keymap,',\n        'containerd.service,containerd container\
    \ runtime,',\n        'cpufrequtils.service,LSB: set CPUFreq kernel parameters,',\n\
    \        'cron.service,Regular background program processing daemon,',\n     \
    \   'crond.service,Command Scheduler,',\n        'cronie.service,Periodic Command\
    \ Scheduler,',\n        'cups-browsed.service,Make remote CUPS printers available\
    \ locally,',\n        'cups-browsed.service,Make remote CUPS printers available\
    \ locally,cups-browsed',\n        'cups.path,CUPS Scheduler,',\n        'cups.service,CUPS\
    \ Scheduler,',\n        'cups.socket,CUPS Scheduler,',\n        'dbus-:1.2-org.pop_os.transition_system@0.service,dbus-:1.2-org.pop_os.transition_system@0.service,0',\n\
    \        'dbus-broker.service,D-Bus System Message Bus,',\n        'dbus.service,D-Bus\
    \ System Message Bus,',\n        'dbus.socket,D-Bus System Message Bus Socket,',\n\
    \        'detect-part-label-duplicates.service,Detect if the system suffers from\
    \ bsc#1089761,',\n        'dhcpcd.service,DHCP Client,',\n        'display-manager.service,Display\
    \ Manager,',\n        'display-manager.service,X11 Server,',\n        'displaylink.service,DisplayLink\
    \ Manager Service,',\n        'dkms.service,Builds and install new kernel modules\
    \ through DKMS,',\n        'dm-event.socket,Device-mapper event daemon FIFOs,',\n\
    \        'dnf-automatic-install.service,dnf automatic install updates,',\n   \
    \     'dnf-automatic-install.timer,dnf-automatic-install timer,',\n        'dnf-makecache.service,dnf\
    \ makecache,',\n        'dnf-makecache.timer,dnf makecache --timer,',\n      \
    \  'docker.service,Docker Application Container Engine,',\n        'docker.socket,Docker\
    \ Socket for the API,',\n        'dpkg-db-backup.timer,Daily dpkg database backup\
    \ timer,',\n        'dracut-shutdown.service,Restore /run/initramfs on shutdown,',\n\
    \        'e2scrub_all.timer,Periodic ext4 Online Metadata Check for All Filesystems,',\n\
    \        'elastic-agent.service,Elastic Agent is a unified agent to observe, monitor\
    \ and protect your system.,',\n        'ElasticEndpoint.service,ElasticEndpoint,',\n\
    \        'finalrd.service,Create final runtime dir for shutdown pivot root,',\n\
    \        'firewall.service,Firewall,',\n        'firewalld.service,firewalld -\
    \ dynamic firewall daemon,',\n        'flatpak-system-helper.service,flatpak system\
    \ helper,',\n        'flatpak-system-update.timer,Flatpak Automatic Update Trigger,',\n\
    \        'fprintd.service,Fingerprint Authentication Daemon,',\n        'fstrim.service,Discard\
    \ unused blocks on filesystems from /etc/fstab,',\n        'fstrim.timer,Discard\
    \ unused blocks once a week,',\n        'fstrim.timer,Discard unused filesystem\
    \ blocks once a week,',\n        'fwupd-refresh.service,Refresh fwupd metadata\
    \ and update motd,fwupd-refresh',\n        'fwupd-refresh.timer,Refresh fwupd\
    \ metadata regularly,',\n        'fwupd.service,Firmware update daemon,',\n  \
    \      'gdm.service,GNOME Display Manager,',\n        'geoclue.service,Location\
    \ Lookup Service,geoclue',\n        'geoipupdate.timer,Weekly GeoIP update,',\n\
    \        'gitsign.service,Keyless Git signing with Sigstore!,',\n        'gnome-remote-desktop.service,GNOME\
    \ Remote Desktop,gnome-remote-desktop',\n        'gssproxy.service,GSSAPI Proxy\
    \ Daemon,',\n        'haproxy.service,HAProxy Load Balancer,',\n        'haveged.service,Entropy\
    \ Daemon based on the HAVEGE algorithm,',\n        'ifupdown-pre.service,Helper\
    \ to synchronize boot up for ifupdown,',\n        'iio-sensor-proxy.service,IIO\
    \ Sensor Proxy service,',\n        'import-state.service,Import network configuration\
    \ from initramfs,',\n        'incus-lxcfs.service,Incus - LXCFS daemon,',\n  \
    \      'incus-startup.service,Incus - Startup check,',\n        'incus-user.socket,Incus\
    \ - Daemon (user unix socket),',\n        'incus.service,Incus - Daemon,',\n \
    \       'incus.service,Incus - Main daemon,',\n        'incus.socket,Incus - Daemon\
    \ (unix socket),',\n        'input-remapper.service,Service to inject keycodes\
    \ without the GUI application,',\n        'ir_agent.service,Rapid7 Insight Agent,root',\n\
    \        'irqbalance.service,irqbalance daemon,',\n        'iscsid.socket,Open-iSCSI\
    \ iscsid Socket,',\n        'iscsiuio.socket,Open-iSCSI iscsiuio Socket,',\n \
    \       'issue-generator.path,Watch for changes in issue snippets,',\n       \
    \ 'iwd.service,Wireless service,',\n        'jeos-firstboot-snapshot.service,SUSE\
    \ JeOS First Boot Wizard - create system snapshot,',\n        'jeos-firstboot.service,SUSE\
    \ JeOS First Boot Wizard,',\n        'kbdsettings.service,Apply settings from\
    \ /etc/sysconfig/keyboard,',\n        'kde-sysmonitor-workaround.service,Workaround\
    \ KDE System Monitor not having the correct caps,',\n        'kdump.service,Crash\
    \ recovery kernel arming,',\n        'kerneloops.service,Tool to automatically\
    \ collect and submit kernel crash signatures,kernoops',\n        'keyboard-setup.service,Set\
    \ the console keyboard layout,',\n        'klog.service,Early Kernel Boot Messages,',\n\
    \        'kmod-static-nodes.service,Create list of static device nodes for the\
    \ current kernel,',\n        'kmod-static-nodes.service,Create List of Static\
    \ Device Nodes,',\n        'kolide-launcher.service,Kolide launcher,',\n     \
    \   'launcher,/usr/local/kolide-k2/bin/launcher,0,system.slice,launcher.kolide-k2.service,0755',\n\
    \        'launcher.kolide-k2.service,The Kolide Launcher,',\n        'ldconfig.service,Rebuild\
    \ Dynamic Linker Cache,',\n        'libvirt-workaround.service,Workaround to relabel\
    \ libvirt files and directories,',\n        'libvirtd-admin.socket,Libvirt admin\
    \ socket,',\n        'libvirtd-ro.socket,Libvirt local read-only socket,',\n \
    \       'libvirtd.service,Virtualization daemon,',\n        'libvirtd.socket,Libvirt\
    \ local socket,',\n        'lightdm.service,Light Display Manager,',\n       \
    \ 'lima-guestagent.service,lima-guestagent,',\n        'livesys-late.service,SYSV:\
    \ Late init script for live image.,',\n        'livesys.service,LSB: Init script\
    \ for live image.,',\n        'lm_sensors.service,Hardware Monitoring Sensors,',\n\
    \        'lm_sensors.service,Initialize hardware monitoring sensors,',\n     \
    \   'lm-sensors.service,Initialize hardware monitoring sensors,',\n        'loadcpufreq.service,LSB:\
    \ Load kernel modules needed to enable cpufreq scaling,',\n        'logrotate-checkconf.service,Logrotate\
    \ configuration check,',\n        'logrotate.service,Rotate log files,',\n   \
    \     'logrotate.timer,Daily rotation of log files,',\n        'logrotate.timer,logrotate.timer,',\n\
    \        'low-memory-monitor.service,Low Memory Monitor,',\n        'lvm2-lvmpolld.socket,LVM2\
    \ poll daemon socket,',\n        'lvm2-monitor.service,Monitoring of LVM2 mirrors,\
    \ snapshots etc. using dmeventd or progress polling,',\n        'lxc-monitord.service,LXC\
    \ Container Monitoring Daemon,',\n        'lxc-net.service,LXC network bridge\
    \ setup,',\n        'lxc.service,LXC Container Initialization and Autoboot Code,',\n\
    \        'lxcfs.service,FUSE filesystem for LXC,',\n        'lxd-installer.socket,Helper\
    \ to install lxd snap on demand,',\n        'machine.slice,Virtual Machine and\
    \ Container Slice,',\n        'man-db.service,Daily man-db regeneration,root',\n\
    \        'man-db.timer,Daily man-db regeneration,',\n        'mcelog.service,Machine\
    \ Check Exception Logging Daemon,',\n        'mlocate-updatedb.timer,Updates mlocate\
    \ database every day,',\n        'ModemManager.service,Modem Manager,root',\n\
    \        'modprobe@efi_pstore.service,Load Kernel Module efi_pstore,',\n     \
    \   'modprobe@pstore_blk.service,Load Kernel Module pstore_blk,',\n        'modprobe@pstore_zone.service,Load\
    \ Kernel Module pstore_zone,',\n        'modprobe@ramoops.service,Load Kernel\
    \ Module ramoops,',\n        'monitorix.service,Monitorix,',\n        'motd-news.timer,Message\
    \ of the Day,',\n        'mount-pstore.service,mount-pstore.service,',\n     \
    \   'multipathd.service,Device-Mapper Multipath Device Controller,',\n       \
    \ 'multipathd.socket,multipathd control socket,',\n        'nessusd.service,The\
    \ Nessus Vulnerability Scanner,',\n        'netcf-transaction.service,Rollback\
    \ uncommitted netcf network config change transactions,',\n        'network-local-commands.service,Extra\
    \ networking commands.,',\n        'network-setup.service,Networking Setup,',\n\
    \        'networkd-dispatcher.service,Dispatcher daemon for systemd-networkd,',\n\
    \        'networking.service,Raise network interfaces,',\n        'NetworkManager-dispatcher.service,Network\
    \ Manager Script Dispatcher Service,',\n        'NetworkManager-wait-online.service,Network\
    \ Manager Wait Online,',\n        'NetworkManager.service,Network Manager,',\n\
    \        'nginx.service,A high performance web server and a reverse proxy server,',\n\
    \        'nginx.service,Nginx Web Server,nginx',\n        'nis-domainname.service,Read\
    \ and set NIS domainname from /etc/sysconfig/network,',\n        'nix-daemon.service,Nix\
    \ Daemon,',\n        'nix-daemon.socket,Nix Daemon Socket,',\n        'nix-gc.timer,nix-gc.timer,',\n\
    \        'nscd.service,Name Service Cache Daemon (nsncd),nscd',\n        'nscd.service,Name\
    \ Service Cache Daemon,nscd',\n        'nvidia-fallback.service,Fallback to nouveau\
    \ as nvidia did not load,',\n        'nvidia-persistenced.service,NVIDIA Persistence\
    \ Daemon,',\n        'nvidia-powerd.service,nvidia-powerd service,',\n       \
    \ 'nvidia-suspend.service,NVIDIA system suspend actions,',\n        'openvpn.service,OpenVPN\
    \ service,',\n        'orbit,/opt/orbit/bin/orbit/linux/stable/orbit,0',\n   \
    \     'orbit.service,Orbit osquery,',\n        'ostree-finalize-staged-hold.service,Hold\
    \ /boot Open for OSTree Finalize Staged Deployment,',\n        'ostree-finalize-staged.path,OSTree\
    \ Monitor Staged Deployment,',\n        'ostree-finalize-staged.service,OSTree\
    \ Finalize Staged Deployment,',\n        'ostree-remount.service,OSTree Remount\
    \ OS/ Bind Mounts,',\n        'packagekit.service,PackageKit Daemon,root',\n \
    \       'passim.service,Local Caching Server,passim',\n        'pcscd.service,PC/SC\
    \ Smart Card Daemon,',\n        'pcscd.socket,PC/SC Smart Card Daemon Activation\
    \ Socket,',\n        'phpsessionclean.timer,Clean PHP session files every 30 mins,',\n\
    \        'plocate-updatedb.service,Update the plocate database,',\n        'plocate-updatedb.timer,Update\
    \ the plocate database daily,',\n        'plymouth-quit-wait.service,Hold until\
    \ boot process finishes up,',\n        'plymouth-quit.service,Terminate Plymouth\
    \ Boot Screen,',\n        'plymouth-read-write.service,Tell Plymouth To Write\
    \ Out Runtime Data,',\n        'plymouth-start.service,Show Plymouth Boot Screen,',\n\
    \        'pmcd.service,Performance Metrics Collector Daemon,',\n        'podman-auto-update.timer,Podman\
    \ auto-update timer,',\n        'podman-restart.service,Podman Start All Containers\
    \ With Restart Policy Set To Always,',\n        'podman.socket,Podman API Socket,',\n\
    \        'polkit.service,Authorization Manager,',\n        'polkit.service,Authorization\
    \ Manager,polkitd',\n        'postfix@-.service,Postfix Mail Transport Agent (instance\
    \ -),',\n        'power-profiles-daemon.service,Power Profiles daemon,',\n   \
    \     'proc-sys-fs-binfmt_misc.automount,Arbitrary Executable File Formats File\
    \ System Automount Point,',\n        'pulseaudio-enable-autospawn.service,LSB:\
    \ Enable pulseaudio autospawn,',\n        'pwrstatd.service,The monitor UPS software.,',\n\
    \        'qemu-kvm.service,QEMU KVM preparation - module, ksm, hugepages,',\n\
    \        'qualys-cloud-agent.service,Qualys cloud agent daemon,',\n        'raid-check.timer,Weekly\
    \ RAID setup health check,',\n        'realmd.service,Realm and Domain Configuration,',\n\
    \        'reflector.service,Refresh Pacman mirrorlist with Reflector.,',\n   \
    \     'reflector.timer,Refresh Pacman mirrorlist weekly with Reflector.,',\n \
    \       'reload-systemd-vconsole-setup.service,Reset console on configuration\
    \ changes,',\n        'resolvconf-pull-resolved.path,resolvconf-pull-resolved.path,',\n\
    \        'resolvconf.service,Nameserver information manager,',\n        'resolvconf.service,resolvconf\
    \ update,',\n        'rngd.service,Hardware RNG Entropy Gatherer Daemon,',\n \
    \       'rpc-statd-notify.service,Notify NFS peers of a restart,',\n        'rpcbind.service,RPC\
    \ Bind,',\n        'rpcbind.socket,RPCbind Server Activation Socket,',\n     \
    \   'rpm-ostree-countme.service,Weekly rpm-ostree Count Me reporting,rpm-ostree',\n\
    \        'rpm-ostree-countme.timer,Weekly rpm-ostree Count Me timer,',\n     \
    \   'rpm-ostreed-automatic.service,rpm-ostree Automatic Update,',\n        'rpm-ostreed-automatic.timer,rpm-ostree\
    \ Automatic Update Trigger,',\n        'rpm-ostreed.service,rpm-ostree System\
    \ Management Daemon,rpm-ostree',\n        'rsyslog.service,System Logging Service,',\n\
    \        'rtkit-daemon.service,RealtimeKit Scheduling Policy Service,',\n    \
    \    'schroot.service,Recover schroot sessions,',\n        'sddm.service,Simple\
    \ Desktop Display Manager,',\n        'serial-getty@hvc0.service,Serial Getty\
    \ on hvc0,',\n        'serial-getty@ttyAMA0.service,Serial Getty on ttyAMA0,',\n\
    \        'serial-getty@ttyS0.service,Serial Getty on ttyS0,',\n        'setroubleshootd.service,SETroubleshoot\
    \ daemon for processing new SELinux denial logs,setroubleshoot',\n        'setvtrgb.service,Set\
    \ console scheme,',\n        'shadow.service,Verify integrity of password and\
    \ group files,',\n        'shadow.timer,Daily verification of password and group\
    \ files,',\n        'smartd.service,Self Monitoring and Reporting Technology (SMART)\
    \ Daemon,',\n        'smartmontools.service,Self Monitoring and Reporting Technology\
    \ (SMART) Daemon,',\n        'snap.canonical-livepatch.canonical-livepatchd.service,Service\
    \ for snap application canonical-livepatch.canonical-livepatchd,',\n        'snap.cups.cups-browsed.service,Service\
    \ for snap application cups.cups-browsed,',\n        'snap.cups.cupsd.service,Service\
    \ for snap application cups.cupsd,',\n        'snap.lxd.daemon.unix.socket,Socket\
    \ unix for snap application lxd.daemon,',\n        'snap.lxd.user-daemon.unix.socket,Socket\
    \ unix for snap application lxd.user-daemon,',\n        'snap.multipass.multipassd.service,Service\
    \ for snap application multipass.multipassd,',\n        'snap.yubioath-desktop.pcscd.service,Service\
    \ for snap application yubioath-desktop.pcscd,',\n        'snapd.apparmor.service,Load\
    \ AppArmor profiles managed internally by snapd,',\n        'snapd.seeded.service,Wait\
    \ until snapd is fully seeded,',\n        'snapd.service,Snap Daemon,',\n    \
    \    'snapd.socket,Socket activation for snappy daemon,',\n        'ssh.service,OpenBSD\
    \ Secure Shell server,',\n        'ssh.socket,OpenBSD Secure Shell server socket,',\n\
    \        'sshd-unix-local.socket,OpenSSH Server Socket (systemd-ssh-generator,\
    \ AF_UNIX Local),',\n        'sshd.service,OpenSSH Daemon,',\n        'sshd.service,OpenSSH\
    \ server daemon,',\n        'sshd.service,SSH Daemon,',\n        'sssd-kcm.service,SSSD\
    \ Kerberos Cache Manager,',\n        'sssd-kcm.service,SSSD Kerberos Cache Manager,sssd',\n\
    \        'sssd-kcm.socket,SSSD Kerberos Cache Manager responder socket,',\n  \
    \      'supergfxd.service,SUPERGFX,',\n        'swap.img.swap,/swap.img,',\n \
    \       'swapfile.swap,/swapfile,',\n        'switcheroo-control.service,Switcheroo\
    \ Control Proxy service,',\n        'swtpm-workaround.service,Workaround swtpm\
    \ not having the correct label,',\n        'syslog.socket,Syslog Socket,',\n \
    \       'sysstat-collect.timer,Run system activity accounting tool every 10 minutes,',\n\
    \        'sysstat-summary.timer,Generate summary of yesterday''s process accounting,',\n\
    \        'sysstat.service,Resets System Activity Logs,root',\n        'system-cups.slice,CUPS\
    \ Slice,',\n        'system.slice,System Slice,',\n        'systemd-ask-password-console.path,Dispatch\
    \ Password Requests to Console Directory Watch,',\n        'systemd-ask-password-plymouth.path,Forward\
    \ Password Requests to Plymouth Directory Watch,',\n        'systemd-ask-password-wall.path,Forward\
    \ Password Requests to Wall Directory Watch,',\n        'systemd-binfmt.service,Set\
    \ Up Additional Binary Formats,',\n        'systemd-boot-random-seed.service,Update\
    \ Boot Loader Random Seed,',\n        'systemd-boot-update.service,Automatic Boot\
    \ Loader Update,',\n        'systemd-bootctl.socket,Boot Entries Service Socket,',\n\
    \        'systemd-coredump.socket,Process Core Dump Socket,',\n        'systemd-creds.socket,Credential\
    \ Encryption/Decryption,',\n        'systemd-fsck-root.service,File System Check\
    \ on Root Device,',\n        'systemd-fsckd.socket,fsck to fsckd communication\
    \ Socket,',\n        'systemd-growfs@-.service,Grow File System on /,',\n    \
    \    'systemd-homed-activate.service,Home Area Activation,',\n        'systemd-homed.service,Home\
    \ Area Manager,',\n        'systemd-hostnamed.service,Hostname Service,',\n  \
    \      'systemd-hostnamed.socket,Hostname Service Socket,',\n        'systemd-hwdb-update.service,Rebuild\
    \ Hardware Database,',\n        'systemd-initctl.socket,initctl Compatibility\
    \ Named Pipe,',\n        'systemd-journal-catalog-update.service,Rebuild Journal\
    \ Catalog,',\n        'systemd-journal-flush.service,Flush Journal to Persistent\
    \ Storage,',\n        'systemd-journald-audit.socket,Journal Audit Socket,',\n\
    \        'systemd-journald-dev-log.socket,Journal Socket (/dev/log),',\n     \
    \   'systemd-journald.service,Journal Service,',\n        'systemd-journald.socket,Journal\
    \ Socket,',\n        'systemd-journald.socket,Journal Sockets,',\n        'systemd-localed.service,Locale\
    \ Service,',\n        'systemd-logind.service,User Login Management,',\n     \
    \   'systemd-machine-id-commit.service,Commit a transient machine-id on disk,',\n\
    \        'systemd-machined.service,Virtual Machine and Container Registration\
    \ Service,',\n        'systemd-modules-load.service,Load Kernel Modules,',\n \
    \       'systemd-mountfsd.socket,DDI File System Mounter Socket,',\n        'systemd-network-generator.service,Generate\
    \ network units from Kernel command line,',\n        'systemd-networkd-wait-online.service,Wait\
    \ for Network to be Configured,',\n        'systemd-networkd.service,Network Configuration,systemd-network',\n\
    \        'systemd-networkd.socket,Network Service Netlink Socket,',\n        'systemd-nsresourced.service,Namespace\
    \ Resource Manager,',\n        'systemd-nsresourced.socket,Namespace Resource\
    \ Manager Socket,',\n        'systemd-oomd.service,Userspace Out-Of-Memory (OOM)\
    \ Killer,systemd-oom',\n        'systemd-oomd.socket,Userspace Out-Of-Memory (OOM)\
    \ Killer Socket,',\n        'systemd-pcrmachine.service,TPM2 PCR Machine ID Measurement,',\n\
    \        'systemd-pcrphase-sysinit.service,TPM2 PCR Barrier (Initialization),',\n\
    \        'systemd-pcrphase.service,TPM2 PCR Barrier (User),',\n        'systemd-pstore.service,Platform\
    \ Persistent Storage Archival,',\n        'systemd-random-seed.service,Load/Save\
    \ OS Random Seed,',\n        'systemd-random-seed.service,Load/Save Random Seed,',\n\
    \        'systemd-remount-fs.service,Remount Root and Kernel File Systems,',\n\
    \        'systemd-resolved.service,Network Name Resolution,systemd-resolve',\n\
    \        'systemd-rfkill.socket,Load/Save RF Kill Switch Status /dev/rfkill Watch,',\n\
    \        'systemd-suspend.service,System Suspend,',\n        'systemd-sysctl.service,Apply\
    \ Kernel Variables,',\n        'systemd-sysext.socket,System Extension Image Management\
    \ (Varlink),',\n        'systemd-sysext.socket,System Extension Image Management,',\n\
    \        'systemd-sysusers.service,Create System Users,',\n        'systemd-timedated.service,Time\
    \ & Date Service,',\n        'systemd-timesyncd.service,Network Time Synchronization,systemd-timesync',\n\
    \        'systemd-tmpfiles-clean.timer,Daily Cleanup of Temporary Directories,',\n\
    \        'systemd-tmpfiles-setup-dev-early.service,Create Static Device Nodes\
    \ in /dev gracefully,',\n        'systemd-tmpfiles-setup-dev.service,Create Static\
    \ Device Nodes in /dev,',\n        'systemd-tmpfiles-setup.service,Create System\
    \ Files and Directories,',\n        'systemd-tmpfiles-setup.service,Create Volatile\
    \ Files and Directories,',\n        'systemd-udev-load-credentials.service,Load\
    \ udev Rules from Credentials,',\n        'systemd-udev-settle.service,Wait for\
    \ udev To Complete Device Initialization,',\n        'systemd-udev-trigger.service,Coldplug\
    \ All udev Devices,',\n        'systemd-udevd-control.socket,udev Control Socket,',\n\
    \        'systemd-udevd-kernel.socket,udev Kernel Socket,',\n        'systemd-udevd.service,Rule-based\
    \ Manager for Device Events and Files,',\n        'systemd-update-done.service,Update\
    \ is Completed,',\n        'systemd-update-utmp.service,Record System Boot/Shutdown\
    \ in UTMP,',\n        'systemd-update-utmp.service,Update UTMP about System Boot/Shutdown,',\n\
    \        'systemd-user-sessions.service,Permit User Sessions,',\n        'systemd-userdbd.service,User\
    \ Database Manager,',\n        'systemd-userdbd.socket,User Database Manager Socket,',\n\
    \        'systemd-vconsole-setup.service,Setup Virtual Console,',\n        'systemd-vconsole-setup.service,Virtual\
    \ Console Setup,',\n        'tailscaled.service,Tailscale node agent,',\n    \
    \    'thermald.service,Thermal Daemon Service,',\n        'tlp.service,TLP system\
    \ startup/shutdown,',\n        'touchegg.service,Touch√©gg Daemon,',\n        'tuned-ppd.service,PPD-to-TuneD\
    \ API Translation Daemon,',\n        'tuned.service,Dynamic System Tuning Daemon,',\n\
    \        'ua-timer.timer,Ubuntu Advantage Timer for running repeated jobs,',\n\
    \        'ua-timer.timer,Ubuntu Pro Timer for running repeated jobs,',\n     \
    \   'ublue-system-setup.service,Configure system,',\n        'ublue-update.service,Universal\
    \ Blue Update Oneshot Service,',\n        'ublue-update.timer,Auto Update System\
    \ Timer For Universal Blue,',\n        'ubuntu-fan.service,Ubuntu FAN network\
    \ setup,',\n        'udisks2.service,Disk Manager,',\n        'ufw.service,Uncomplicated\
    \ firewall,',\n        'unattended-upgrades.service,Unattended Upgrades Shutdown,',\n\
    \        'unbound-anchor.timer,daily update of the root trust anchor for DNSSEC,',\n\
    \        'update-notifier-download.timer,Download data for packages that failed\
    \ at package install time,',\n        'update-notifier-motd.timer,Check to see\
    \ whether there is a new version of Ubuntu available,',\n        'updatedb.timer,Daily\
    \ locate database update,',\n        'upower.service,Daemon for power management,',\n\
    \        'uresourced.service,User resource assignment daemon,',\n        'usbmuxd.service,Socket\
    \ daemon for the usbmux protocol used by Apple devices,',\n        'user.slice,User\
    \ and Session Slice,',\n        'uuidd.service,Daemon for generating UUIDs,uuidd',\n\
    \        'uuidd.socket,UUID daemon activation socket,',\n        'v4l2-relayd.service,v4l2-relay\
    \ daemon service,',\n        'vboxautostart-service.service,vboxautostart-service.service,',\n\
    \        'vboxballoonctrl-service.service,vboxballoonctrl-service.service,',\n\
    \        'vboxdrv.service,VirtualBox Linux kernel module,',\n        'vboxweb-service.service,vboxweb-service.service,',\n\
    \        'velociraptor_client.service,Velociraptor linux client,',\n        'velociraptor_server.service,Velociraptor\
    \ server,velociraptor',\n        'virtinterfaced-admin.socket,libvirt interface\
    \ daemon admin socket,',\n        'virtinterfaced-ro.socket,libvirt interface\
    \ daemon read-only socket,',\n        'virtinterfaced.socket,libvirt interface\
    \ daemon socket,',\n        'virtinterfaced.socket,Libvirt interface local socket,',\n\
    \        'virtlockd-admin.socket,libvirt locking daemon admin socket,',\n    \
    \    'virtlockd.socket,libvirt locking daemon socket,',\n        'virtlockd.socket,Virtual\
    \ machine lock manager socket,',\n        'virtlogd-admin.socket,libvirt logging\
    \ daemon admin socket,',\n        'virtlogd-admin.socket,Virtual machine log manager\
    \ socket,',\n        'virtlogd.service,Virtual machine log manager,',\n      \
    \  'virtlogd.socket,libvirt logging daemon socket,',\n        'virtlogd.socket,Virtual\
    \ machine log manager socket,',\n        'virtlxcd-admin.socket,libvirt LXC daemon\
    \ admin socket,',\n        'virtlxcd-ro.socket,libvirt LXC daemon read-only socket,',\n\
    \        'virtlxcd.socket,libvirt LXC daemon socket,',\n        'virtnetworkd-admin.socket,libvirt\
    \ network daemon admin socket,',\n        'virtnetworkd-ro.socket,libvirt network\
    \ daemon read-only socket,',\n        'virtnetworkd.socket,libvirt network daemon\
    \ socket,',\n        'virtnetworkd.socket,Libvirt network local socket,',\n  \
    \      'virtnodedevd-admin.socket,libvirt nodedev daemon admin socket,',\n   \
    \     'virtnodedevd-ro.socket,libvirt nodedev daemon read-only socket,',\n   \
    \     'virtnodedevd.socket,libvirt nodedev daemon socket,',\n        'virtnodedevd.socket,Libvirt\
    \ nodedev local socket,',\n        'virtnwfilterd-admin.socket,libvirt nwfilter\
    \ daemon admin socket,',\n        'virtnwfilterd-ro.socket,libvirt nwfilter daemon\
    \ read-only socket,',\n        'virtnwfilterd.socket,libvirt nwfilter daemon socket,',\n\
    \        'virtnwfilterd.socket,Libvirt nwfilter local socket,',\n        'virtproxyd-admin.socket,libvirt\
    \ proxy daemon admin socket,',\n        'virtproxyd-ro.socket,libvirt proxy daemon\
    \ read-only socket,',\n        'virtproxyd.socket,libvirt proxy daemon socket,',\n\
    \        'virtproxyd.socket,Libvirt proxy local socket,',\n        'virtqemud-admin.socket,Libvirt\
    \ qemu admin socket,',\n        'virtqemud-admin.socket,libvirt QEMU daemon admin\
    \ socket,',\n        'virtqemud-ro.socket,libvirt QEMU daemon read-only socket,',\n\
    \        'virtqemud-ro.socket,Libvirt qemu local read-only socket,',\n       \
    \ 'virtqemud.service,Virtualization qemu daemon,',\n        'virtqemud.socket,libvirt\
    \ QEMU daemon socket,',\n        'virtqemud.socket,Libvirt qemu local socket,',\n\
    \        'virtsecretd-admin.socket,libvirt secret daemon admin socket,',\n   \
    \     'virtsecretd-ro.socket,libvirt secret daemon read-only socket,',\n     \
    \   'virtsecretd.socket,libvirt secret daemon socket,',\n        'virtsecretd.socket,Libvirt\
    \ secret local socket,',\n        'virtstoraged-admin.socket,libvirt storage daemon\
    \ admin socket,',\n        'virtstoraged-ro.socket,libvirt storage daemon read-only\
    \ socket,',\n        'virtstoraged.socket,libvirt storage daemon socket,',\n \
    \       'virtstoraged.socket,Libvirt storage local socket,',\n        'virtvboxd-admin.socket,libvirt\
    \ VirtualBox daemon admin socket,',\n        'virtvboxd-ro.socket,libvirt VirtualBox\
    \ daemon read-only socket,',\n        'virtvboxd.socket,libvirt VirtualBox daemon\
    \ socket,',\n        'vnstat.service,vnStat network traffic monitor,vnstat',\n\
    \        'whoopsie.path,Start whoopsie on modification of the /var/crash directory,',\n\
    \        'wicked.service,wicked managed network interfaces,',\n        'wickedd-auto4.service,wicked\
    \ AutoIPv4 supplicant service,',\n        'wickedd-dhcp4.service,wicked DHCPv4\
    \ supplicant service,',\n        'wickedd-dhcp6.service,wicked DHCPv6 supplicant\
    \ service,',\n        'wickedd-nanny.service,wicked network nanny service,',\n\
    \        'wickedd.service,wicked network management service daemon,',\n      \
    \  'wpa_supplicant.service,WPA supplicant,',\n        'zfs-import-cache.service,Import\
    \ ZFS pools by cache file,',\n        'zfs-load-key-rpool.service,Load ZFS key\
    \ for rpool,',\n        'zfs-load-module.service,Install ZFS kernel module,',\n\
    \        'zfs-mount.service,Mount ZFS filesystems,',\n        'zfs-scrub.service,ZFS\
    \ pools scrubbing,',\n        'zfs-scrub.timer,zfs-scrub.timer,',\n        'zfs-share.service,ZFS\
    \ file system shares,',\n        'zfs-snapshot-daily.service,ZFS auto-snapshotting\
    \ every day,',\n        'zfs-snapshot-frequent.service,ZFS auto-snapshotting every\
    \ 15 mins,',\n        'zfs-snapshot-hourly.service,ZFS auto-snapshotting every\
    \ hour,',\n        'zfs-volume-wait.service,Wait for ZFS Volume (zvol) links in\
    \ /dev,',\n        'zfs-zed.service,ZFS Event Daemon (zed),',\n        'znapzend.service,ZnapZend\
    \ - ZFS Backup System,root',\n        'zpool-trim.service,ZFS pools trim,',\n\
    \        'zpool-trim.timer,zpool-trim.timer,'\n      )\n      OR exception_key\
    \ LIKE 'boot-sysctl.service,Apply Kernel Variables for % from /boot,'\n      OR\
    \ exception_key LIKE 'dbus-:1.%-org.freedesktop.problems@%.service,dbus-:%.%-org.freedesktop.problems@%.service,0'\n\
    \      OR exception_key LIKE 'drkonqi-coredump-processor@%.service,Pass systemd-coredump\
    \ journal entries to relevant user for potential DrKonqi handling,'\n      OR\
    \ exception_key LIKE 'machine-qemu%.scope,Virtual Machine qemu%,'\n      OR exception_key\
    \ LIKE 'run-media-%.mount,run-media-%.mount,'\n      OR exception_key LIKE 'snap-aws\\\
    x2dcli-%.mount,Mount unit for aws-cli, revision %'\n      OR exception_key LIKE\
    \ 'systemd-cryptsetup@%.service,Cryptography Setup for %,'\n      OR exception_key\
    \ LIKE 'zfs-snapshot-%.service,zfs-snapshot-%.service,'\n      OR exception_key\
    \ LIKE 'zfs-snapshot-%.timer,zfs-snapshot-%.timer,'\n      OR id LIKE ''\n   \
    \   OR id LIKE 'akmods@%64.service'\n      OR id LIKE 'dev-disk-by%.swap'\n  \
    \    OR id LIKE 'dev-mapper-%.swap'\n      OR id LIKE 'dev-zram%.swap'\n     \
    \ OR id LIKE 'docker-%.scope'\n      OR id LIKE 'getty@tty%.service'\n      OR\
    \ id LIKE 'home-manager-%.service'\n      OR id LIKE 'lvm2-pvscan@%.service'\n\
    \      OR id LIKE 'session-%.scope'\n      OR id LIKE 'system-systemd%cryptsetup.slice'\n\
    \      OR id LIKE 'systemd-backlight@%.service'\n      OR id LIKE 'systemd-cryptsetup@luks%.service'\n\
    \      OR id LIKE 'systemd-cryptsetup@nvme%.service'\n      OR id LIKE 'systemd-fsck@dev-disk-by%service'\n\
    \      OR id LIKE 'systemd-zram-setup@zram%.service'\n      OR id LIKE 'user-runtime-dir@%.service'\n\
    \      OR id LIKE 'user@%.service'\n    )\n  )\n"
  platform: linux
  interval: 3600
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

- name: CDK - Docker Container Mounting Root
  description: Detect the execution of a Docker containing mounting the root filesystem
    This attack is very quick, so the likelihood of finding a culprit is entirely
    dependent on the polling time.
  query: "SELECT\n  command,\n  image_id,\n  path,\n  source,\n  destination,\n  security_options,\n\
    \  started_at,\n  image\nFROM\n  docker_container_mounts AS dcm\n  LEFT JOIN docker_containers\
    \ dc ON dcm.id = dc.id\nWHERE\n  dcm.source = \"/\"\n  AND image NOT IN (\n  \
    \  \"ghcr.io/ublue-os/bluefin-cli\",\n    \"ghcr.io/ublue-os/ubuntu-toolbox\"\n\
    \  )\n  AND image NOT LIKE '%wolfi-sdk-toolbox:latest'\n"
  platform: linux
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

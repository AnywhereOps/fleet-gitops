- name: CDK - Unexpected Var Run Linux
  description: Find unexpected regular files in /var/run
  query: "SELECT\n  file.filename,\n  uid,\n  gid,\n  mode,\n  file.ctime,\n  file.atime,\n\
    \  file.mtime,\n  file.size,\n  hash.sha256,\n  magic.data\nFROM\n  file\n  LEFT\
    \ JOIN hash on file.path = hash.path\n  LEFT JOIN magic ON file.path = magic.path\n\
    WHERE\n  file.directory = \"/var/run\"\n  AND file.type = \"regular\"\n  AND file.filename\
    \ NOT IN (\n    'acpid.pid',\n    'adduser',\n    'agetty.reload',\n    'alsactl.pid',\n\
    \    'apcupsd.pid',\n    'apport.lock',\n    'atd.pid',\n    'atopacctd.pid',\n\
    \    'auditd.pid',\n    'bluetooth.blocked',\n    'bootupd-lock',\n    'casper-md5check.json',\n\
    \    'com.rapid7.cnchub.pid',\n    'com.rapid7.component_insight_agent.pid',\n\
    \    'com.rapid7.ir_agent.pid',\n    'cron.reboot',\n    'crond.pid',\n    'crond.reboot',\n\
    \    'dmeventd.pid',\n    'dnf-metadata.lock',\n    'do-not-hibernate',\n    'docker.pid',\n\
    \    'firefox-restart-required',\n    'gdm3.pid',\n    'greetd.run',\n    'gssproxy.pid',\n\
    \    'haproxy.pid',\n    'keyd.socket.lock',\n    'libvirtd.pid',\n    'lightdm.pid',\n\
    \    'lima-boot-done',\n    'lima-ssh-ready',\n    'lxcfs.pid',\n    'machine-id',\n\
    \    'mcelog.pid',\n    'metalauncher.pid',\n    'motd',\n    'motd.dynamic',\n\
    \    'multipathd.pid',\n    'nginx.pid',\n    'nvidia-powerd.pid',\n    'nvidia_runtimepm_enabled',\n\
    \    'nvidia_runtimepm_supported',\n    'ostree-booted',\n    'pacct_source',\n\
    \    'pulseaudio-enable-autospawn',\n    'reboot-required',\n    'reboot-required.pkgs',\n\
    \    'rsyslogd.pid',\n    'sm-notify.pid',\n    'sshd.pid',\n    'ublue-update.lock',\n\
    \    'ufw.lock',\n    'unattended-upgrades.lock',\n    'unattended-upgrades.pid',\n\
    \    'unattended-upgrades.progress',\n    'usbmuxd.pid',\n    'utmp',\n    'uupd.lock',\n\
    \    'virtlockd.pid',\n    'virtlogd.pid',\n    'xtables.lock',\n    'zed.pid',\n\
    \    'zed.state',\n    'zfs_fs_name',\n    'zfs_unlock_complete'\n  )\n  AND NOT\
    \ file.filename LIKE 'u-d-c-%'\nGROUP BY\n  file.path;\n"
  platform: linux
  interval: 3600
  observer_can_run: true
  automations_enabled: false
  logging: snapshot
  discard_data: false

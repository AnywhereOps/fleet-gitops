- name: Software (Linux)
  description: Gathers information about software installed on a device running linux.
  query: "WITH cached_users AS (WITH cached_groups AS (select * from groups)\n SELECT\
    \ uid, uuid, username, type, groupname, shell\n FROM users LEFT JOIN cached_groups\
    \ USING (gid)\n WHERE type <> 'special' AND shell NOT LIKE '%/false' AND shell\
    \ NOT LIKE '%/nologin' AND shell NOT LIKE '%/shutdown' AND shell NOT LIKE '%/halt'\
    \ AND username NOT LIKE '%$' AND username NOT LIKE '\\_%' ESCAPE '\\' AND NOT\
    \ (username = 'sync' AND shell ='/bin/sync' AND directory <> ''))\nSELECT\n  name\
    \ AS name,\n  version AS version,\n  '' AS extension_id,\n  '' AS browser,\n \
    \ 'deb_packages' AS source,\n  '' AS release,\n  '' AS vendor,\n  '' AS arch,\n\
    \  '' AS installed_path\nFROM deb_packages\nWHERE status LIKE '% ok installed'\n\
    UNION\nSELECT\n  package AS name,\n  version AS version,\n  '' AS extension_id,\n\
    \  '' AS browser,\n  'portage_packages' AS source,\n  '' AS release,\n  '' AS\
    \ vendor,\n  '' AS arch,\n  '' AS installed_path\nFROM portage_packages\nUNION\n\
    SELECT\n  name AS name,\n  version AS version,\n  '' AS extension_id,\n  '' AS\
    \ browser,\n  'rpm_packages' AS source,\n  release AS release,\n  vendor AS vendor,\n\
    \  arch AS arch,\n  '' AS installed_path\nFROM rpm_packages\nUNION\nSELECT\n \
    \ name AS name,\n  version AS version,\n  '' AS extension_id,\n  '' AS browser,\n\
    \  'npm_packages' AS source,\n  '' AS release,\n  '' AS vendor,\n  '' AS arch,\n\
    \  path AS installed_path\nFROM npm_packages\nUNION\nSELECT\n  name AS name,\n\
    \  version AS version,\n  identifier AS extension_id,\n  browser_type AS browser,\n\
    \  'chrome_extensions' AS source,\n  '' AS release,\n  '' AS vendor,\n  '' AS\
    \ arch,\n  path AS installed_path\nFROM cached_users CROSS JOIN chrome_extensions\
    \ USING (uid)\nUNION\nSELECT\n  name AS name,\n  version AS version,\n  identifier\
    \ AS extension_id,\n  'firefox' AS browser,\n  'firefox_addons' AS source,\n \
    \ '' AS release,\n  '' AS vendor,\n  '' AS arch,\n  path AS installed_path\nFROM\
    \ cached_users CROSS JOIN firefox_addons USING (uid);\n"
  platform: linux
